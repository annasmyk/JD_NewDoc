<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Reg-Arima models | JDemetra+ online documentation</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Reg-Arima models | JDemetra+ online documentation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Reg-Arima models | JDemetra+ online documentation" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Anna Smyk" />


<meta name="date" content="2022-05-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spectral-analysis-principles-and-tools.html"/>
<link rel="next" href="moving-average-based-decomposition.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">JDemetra+ online documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="jdemetra-software.html"><a href="jdemetra-software.html"><i class="fa fa-check"></i><b>1</b> JDemetra+ Software</a>
<ul>
<li class="chapter" data-level="1.1" data-path="jdemetra-software.html"><a href="jdemetra-software.html#structure-of-this-book"><i class="fa fa-check"></i><b>1.1</b> Structure of this book</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="jdemetra-software.html"><a href="jdemetra-software.html#available-algorithms"><i class="fa fa-check"></i><b>1.1.1</b> Available algorithms</a></li>
<li class="chapter" data-level="1.1.2" data-path="jdemetra-software.html"><a href="jdemetra-software.html#tools-to-access-the-functions"><i class="fa fa-check"></i><b>1.1.2</b> Tools to access the functions</a></li>
<li class="chapter" data-level="1.1.3" data-path="jdemetra-software.html"><a href="jdemetra-software.html#underlying-statistical-methods"><i class="fa fa-check"></i><b>1.1.3</b> Underlying Statistical Methods</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="jdemetra-software.html"><a href="jdemetra-software.html#audience"><i class="fa fa-check"></i><b>1.2</b> Audience</a></li>
<li class="chapter" data-level="1.3" data-path="jdemetra-software.html"><a href="jdemetra-software.html#how-jdemetra-came-to-be"><i class="fa fa-check"></i><b>1.3</b> How Jdemetra+ came to be</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quick-start-with.html"><a href="quick-start-with.html"><i class="fa fa-check"></i><b>2</b> Quick start with…</a>
<ul>
<li class="chapter" data-level="2.1" data-path="quick-start-with.html"><a href="quick-start-with.html#seasonal-adjustment"><i class="fa fa-check"></i><b>2.1</b> Seasonal Adjustment</a></li>
<li class="chapter" data-level="2.2" data-path="quick-start-with.html"><a href="quick-start-with.html#seasonal-adjustment-of-high-frequency-data"><i class="fa fa-check"></i><b>2.2</b> Seasonal Adjustment of High-Frequency Data</a></li>
<li class="chapter" data-level="2.3" data-path="quick-start-with.html"><a href="quick-start-with.html#use-of-jd-algorithms-in-r"><i class="fa fa-check"></i><b>2.3</b> Use of JD+ algorithms in R</a></li>
<li class="chapter" data-level="2.4" data-path="quick-start-with.html"><a href="quick-start-with.html#use-of-jd-graphical-interface"><i class="fa fa-check"></i><b>2.4</b> Use of JD+ graphical interface</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="main-functions-overview.html"><a href="main-functions-overview.html"><i class="fa fa-check"></i><b>3</b> Main functions overview</a>
<ul>
<li class="chapter" data-level="3.1" data-path="main-functions-overview.html"><a href="main-functions-overview.html#seasonal-adjustment-algorithms"><i class="fa fa-check"></i><b>3.1</b> Seasonal adjustment algorithms</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="main-functions-overview.html"><a href="main-functions-overview.html#data-frequencies"><i class="fa fa-check"></i><b>3.1.1</b> Data frequencies</a></li>
<li class="chapter" data-level="3.1.2" data-path="main-functions-overview.html"><a href="main-functions-overview.html#x-13"><i class="fa fa-check"></i><b>3.1.2</b> X-13</a></li>
<li class="chapter" data-level="3.1.3" data-path="main-functions-overview.html"><a href="main-functions-overview.html#stl"><i class="fa fa-check"></i><b>3.1.3</b> STL</a></li>
<li class="chapter" data-level="3.1.4" data-path="main-functions-overview.html"><a href="main-functions-overview.html#tramo-seats"><i class="fa fa-check"></i><b>3.1.4</b> Tramo-Seats</a></li>
<li class="chapter" data-level="3.1.5" data-path="main-functions-overview.html"><a href="main-functions-overview.html#basic-strcutural-models"><i class="fa fa-check"></i><b>3.1.5</b> Basic Strcutural models</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="main-functions-overview.html"><a href="main-functions-overview.html#trend-cycle-estimation"><i class="fa fa-check"></i><b>3.2</b> Trend-cycle estimation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html"><i class="fa fa-check"></i><b>4</b> Seasonal Adjustment</a>
<ul>
<li class="chapter" data-level="4.1" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#motivation"><i class="fa fa-check"></i><b>4.1</b> Motivation</a></li>
<li class="chapter" data-level="4.2" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#unobserved-components-uc"><i class="fa fa-check"></i><b>4.2</b> Unobserved Components (UC)</a></li>
<li class="chapter" data-level="4.3" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#seasonality-tests"><i class="fa fa-check"></i><b>4.3</b> Seasonality tests</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#overview"><i class="fa fa-check"></i><b>4.3.1</b> Overview</a></li>
<li class="chapter" data-level="4.3.2" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#f-test-on-seasonal-dummies"><i class="fa fa-check"></i><b>4.3.2</b> F-test on seasonal dummies</a></li>
<li class="chapter" data-level="4.3.3" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#qs-test-on-autocorrelation-at-seasonal-lags"><i class="fa fa-check"></i><b>4.3.3</b> QS Test on autocorrelation at seasonal lags</a></li>
<li class="chapter" data-level="4.3.4" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#qs-test-for-seasonality-bis-solve-this"><i class="fa fa-check"></i><b>4.3.4</b> QS Test for seasonality (BIS : solve this)</a></li>
<li class="chapter" data-level="4.3.5" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#kurskall-wallis"><i class="fa fa-check"></i><b>4.3.5</b> Kurskall-Wallis</a></li>
<li class="chapter" data-level="4.3.6" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#friedman-test-stable-seasonality-test"><i class="fa fa-check"></i><b>4.3.6</b> Friedman test (stable seasonality test)</a></li>
<li class="chapter" data-level="4.3.7" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#stable-seasonality-test-missing"><i class="fa fa-check"></i><b>4.3.7</b> Stable seasonality test (missing)</a></li>
<li class="chapter" data-level="4.3.8" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#moving-seasonality-test"><i class="fa fa-check"></i><b>4.3.8</b> Moving seasonality test</a></li>
<li class="chapter" data-level="4.3.9" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#identifiable-seasonality"><i class="fa fa-check"></i><b>4.3.9</b> Identifiable seasonality</a></li>
<li class="chapter" data-level="4.3.10" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#combined-seasonality-test"><i class="fa fa-check"></i><b>4.3.10</b> Combined seasonality test</a></li>
<li class="chapter" data-level="4.3.11" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#spectral-analysis"><i class="fa fa-check"></i><b>4.3.11</b> Spectral analysis</a></li>
<li class="chapter" data-level="4.3.12" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#example-of-non-seasonal-series"><i class="fa fa-check"></i><b>4.3.12</b> Example of non seasonal series</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#calendar-correction"><i class="fa fa-check"></i><b>4.4</b> Calendar correction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#tests-for-residual-trading-days"><i class="fa fa-check"></i><b>4.4.1</b> Tests for residual trading days</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#outliers-and-intervention-variables"><i class="fa fa-check"></i><b>4.5</b> Outliers and intervention variables</a></li>
<li class="chapter" data-level="4.6" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#pre-adjustment"><i class="fa fa-check"></i><b>4.6</b> Pre-adjustment</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#overview-1"><i class="fa fa-check"></i><b>4.6.1</b> Overview</a></li>
<li class="chapter" data-level="4.6.2" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#transformation-choices"><i class="fa fa-check"></i><b>4.6.2</b> Transformation choices</a></li>
<li class="chapter" data-level="4.6.3" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#reg-arima-linarization"><i class="fa fa-check"></i><b>4.6.3</b> Reg-Arima linarization</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#decomposition"><i class="fa fa-check"></i><b>4.7</b> Decomposition</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#x-11-moving-average-based-decomposition"><i class="fa fa-check"></i><b>4.7.1</b> X-11 moving average based decomposition</a></li>
<li class="chapter" data-level="4.7.2" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#model-based-decomposition"><i class="fa fa-check"></i><b>4.7.2</b> Model based decomposition</a></li>
<li class="chapter" data-level="4.7.3" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#quality-assesment-of-the-seasonal-adjustement-process"><i class="fa fa-check"></i><b>4.7.3</b> Quality assesment of the seasonal adjustement process</a></li>
<li class="chapter" data-level="4.7.4" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#non-significant-irregular-1"><i class="fa fa-check"></i><b>4.7.4</b> Non significant irregular</a></li>
<li class="chapter" data-level="4.7.5" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#qs-test"><i class="fa fa-check"></i><b>4.7.5</b> QS test</a></li>
<li class="chapter" data-level="4.7.6" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#f-test-1"><i class="fa fa-check"></i><b>4.7.6</b> F test</a></li>
<li class="chapter" data-level="4.7.7" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#sliding-spans"><i class="fa fa-check"></i><b>4.7.7</b> Sliding spans</a></li>
<li class="chapter" data-level="4.7.8" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#revision-policies"><i class="fa fa-check"></i><b>4.7.8</b> Revision policies</a></li>
<li class="chapter" data-level="4.7.9" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#practical-steps"><i class="fa fa-check"></i><b>4.7.9</b> Practical steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html"><i class="fa fa-check"></i><b>5</b> High Frequency data (seasonal adjustment)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#motivation-1"><i class="fa fa-check"></i><b>5.1</b> Motivation</a></li>
<li class="chapter" data-level="5.2" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#unobserved-components"><i class="fa fa-check"></i><b>5.2</b> Unobserved Components</a></li>
<li class="chapter" data-level="5.3" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#seasonality-tests-1"><i class="fa fa-check"></i><b>5.3</b> Seasonality tests</a></li>
<li class="chapter" data-level="5.4" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#calendar-correction-1"><i class="fa fa-check"></i><b>5.4</b> Calendar correction</a></li>
<li class="chapter" data-level="5.5" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#outliers-and-intervention-variables-1"><i class="fa fa-check"></i><b>5.5</b> Outliers and intervention variables</a></li>
<li class="chapter" data-level="5.6" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#pre-adjustment-1"><i class="fa fa-check"></i><b>5.6</b> Pre-adjustment</a></li>
<li class="chapter" data-level="5.7" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#decomposition-1"><i class="fa fa-check"></i><b>5.7</b> Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html"><i class="fa fa-check"></i><b>6</b> Generating Calendar regressors and other input variables</a>
<ul>
<li class="chapter" data-level="6.1" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html#motivation-2"><i class="fa fa-check"></i><b>6.1</b> Motivation</a></li>
<li class="chapter" data-level="6.2" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html#underlying-theory"><i class="fa fa-check"></i><b>6.2</b> Underlying theory</a></li>
<li class="chapter" data-level="6.3" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html#available-tools"><i class="fa fa-check"></i><b>6.3</b> Available Tools</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html#gui"><i class="fa fa-check"></i><b>6.3.1</b> GUI</a></li>
<li class="chapter" data-level="6.3.2" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html#rjd3modelling-package"><i class="fa fa-check"></i><b>6.3.2</b> Rjd3modelling package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="outlier-detection.html"><a href="outlier-detection.html"><i class="fa fa-check"></i><b>7</b> Outlier detection</a>
<ul>
<li class="chapter" data-level="7.1" data-path="outlier-detection.html"><a href="outlier-detection.html#motivation-3"><i class="fa fa-check"></i><b>7.1</b> Motivation</a></li>
<li class="chapter" data-level="7.2" data-path="outlier-detection.html"><a href="outlier-detection.html#with-reg-arima-models"><i class="fa fa-check"></i><b>7.2</b> With Reg Arima models</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="outlier-detection.html"><a href="outlier-detection.html#part-of-preadjustment"><i class="fa fa-check"></i><b>7.2.1</b> Part of preadjustment</a></li>
<li class="chapter" data-level="7.2.2" data-path="outlier-detection.html"><a href="outlier-detection.html#specific-terror-tool"><i class="fa fa-check"></i><b>7.2.2</b> specific TERROR tool</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="outlier-detection.html"><a href="outlier-detection.html#with-structural-models"><i class="fa fa-check"></i><b>7.3</b> With structural models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modelling-time-series.html"><a href="modelling-time-series.html"><i class="fa fa-check"></i><b>8</b> Modelling Time Series</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modelling-time-series.html"><a href="modelling-time-series.html#motivation-4"><i class="fa fa-check"></i><b>8.1</b> Motivation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="benchmarking-and-temporal-disagreggation.html"><a href="benchmarking-and-temporal-disagreggation.html"><i class="fa fa-check"></i><b>9</b> Benchmarking and temporal disagreggation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="benchmarking-and-temporal-disagreggation.html"><a href="benchmarking-and-temporal-disagreggation.html#benchmarking-overview"><i class="fa fa-check"></i><b>9.1</b> Benchmarking overview</a></li>
<li class="chapter" data-level="9.2" data-path="benchmarking-and-temporal-disagreggation.html"><a href="benchmarking-and-temporal-disagreggation.html#underlying-theory-1"><i class="fa fa-check"></i><b>9.2</b> Underlying Theory</a></li>
<li class="chapter" data-level="9.3" data-path="benchmarking-and-temporal-disagreggation.html"><a href="benchmarking-and-temporal-disagreggation.html#tools"><i class="fa fa-check"></i><b>9.3</b> Tools</a></li>
<li class="chapter" data-level="9.4" data-path="benchmarking-and-temporal-disagreggation.html"><a href="benchmarking-and-temporal-disagreggation.html#references-4"><i class="fa fa-check"></i><b>9.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="trend-cycle-estimation-1.html"><a href="trend-cycle-estimation-1.html"><i class="fa fa-check"></i><b>10</b> Trend-cycle estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="trend-cycle-estimation-1.html"><a href="trend-cycle-estimation-1.html#motivation-5"><i class="fa fa-check"></i><b>10.1</b> Motivation</a></li>
<li class="chapter" data-level="10.2" data-path="trend-cycle-estimation-1.html"><a href="trend-cycle-estimation-1.html#underlying-theory-2"><i class="fa fa-check"></i><b>10.2</b> Underlying Theory</a></li>
<li class="chapter" data-level="10.3" data-path="trend-cycle-estimation-1.html"><a href="trend-cycle-estimation-1.html#tools-1"><i class="fa fa-check"></i><b>10.3</b> Tools</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="nowcasting.html"><a href="nowcasting.html"><i class="fa fa-check"></i><b>11</b> Nowcasting</a></li>
<li class="chapter" data-level="12" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html"><i class="fa fa-check"></i><b>12</b> Graphical User Interface</a>
<ul>
<li class="chapter" data-level="12.1" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#overview-2"><i class="fa fa-check"></i><b>12.1</b> Overview</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#chapter-oragnisation-remarks"><i class="fa fa-check"></i><b>12.1.1</b> Chapter oragnisation remarks</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#list-of-available-algorithms-and-features"><i class="fa fa-check"></i><b>12.2</b> List of Available Algorithms and features</a></li>
<li class="chapter" data-level="12.3" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#installation-procedure"><i class="fa fa-check"></i><b>12.3</b> Installation Procedure</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#running-jdemetra"><i class="fa fa-check"></i><b>12.3.1</b> Running JDemetra+</a></li>
<li class="chapter" data-level="12.3.2" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#closing-jdemetra"><i class="fa fa-check"></i><b>12.3.2</b> Closing JDemetra+</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#global-structure"><i class="fa fa-check"></i><b>12.4</b> Global structure</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#interface-starting-winwow"><i class="fa fa-check"></i><b>12.4.1</b> Interface Starting Winwow</a></li>
<li class="chapter" data-level="12.4.2" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#application-menu"><i class="fa fa-check"></i><b>12.4.2</b> Application menu</a></li>
<li class="chapter" data-level="12.4.3" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#results-panel"><i class="fa fa-check"></i><b>12.4.3</b> Results panel</a></li>
<li class="chapter" data-level="12.4.4" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#menus"><i class="fa fa-check"></i><b>12.4.4</b> Menus</a></li>
<li class="chapter" data-level="12.4.5" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#anomaly-detection"><i class="fa fa-check"></i><b>12.4.5</b> Anomaly Detection</a></li>
<li class="chapter" data-level="12.4.6" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#modelling"><i class="fa fa-check"></i><b>12.4.6</b> Modelling</a></li>
<li class="chapter" data-level="12.4.7" data-path="quick-start-with.html"><a href="quick-start-with.html#seasonal-adjustment"><i class="fa fa-check"></i><b>12.4.7</b> Seasonal Adjustment</a></li>
<li class="chapter" data-level="12.4.8" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#importing-data-the-providers-window"><i class="fa fa-check"></i><b>12.4.8</b> Importing data : the <em>providers</em> window</a></li>
<li class="chapter" data-level="12.4.9" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#charts"><i class="fa fa-check"></i><b>12.4.9</b> Charts</a></li>
<li class="chapter" data-level="12.4.10" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#workspace-window-set-up-your-work-environnement"><i class="fa fa-check"></i><b>12.4.10</b> Workspace Window : set up your work environnement</a></li>
<li class="chapter" data-level="12.4.11" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#section"><i class="fa fa-check"></i><b>12.4.11</b> </a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#seasonal-adjustment-2"><i class="fa fa-check"></i><b>12.5</b> Seasonal adjustment</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#run-a-fully-automatic-sa-processing"><i class="fa fa-check"></i><b>12.5.1</b> Run a fully automatic SA processing</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#an-automatic-seasonal-adjustment"><i class="fa fa-check"></i><b>12.6</b> An automatic seasonal adjustment</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#simple-seasonal-adjustment-of-a-single-time-series"><i class="fa fa-check"></i><b>12.6.1</b> Simple seasonal adjustment of a single time series</a></li>
<li class="chapter" data-level="12.6.2" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#specifications-documents-multi-documents"><i class="fa fa-check"></i><b>12.6.2</b> Specifications, documents, multi-documents</a></li>
<li class="chapter" data-level="12.6.3" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#defining-and-modifying-a-specification"><i class="fa fa-check"></i><b>12.6.3</b> Defining and modifying a specification</a></li>
<li class="chapter" data-level="12.6.4" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#tramo-seats-specification-setting"><i class="fa fa-check"></i><b>12.6.4</b> Tramo-seats specification setting</a></li>
<li class="chapter" data-level="12.6.5" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#reg-arima-linearization"><i class="fa fa-check"></i><b>12.6.5</b> Reg arima linearization</a></li>
<li class="chapter" data-level="12.6.6" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#x-11-specification-setting"><i class="fa fa-check"></i><b>12.6.6</b> X-11 Specification setting</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#adding-user-defined-variables"><i class="fa fa-check"></i><b>12.7</b> Adding User-defined variables</a></li>
<li class="chapter" data-level="12.8" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#seasonality-tests-2"><i class="fa fa-check"></i><b>12.8</b> Seasonality tests</a></li>
<li class="chapter" data-level="12.9" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#series-modelling"><i class="fa fa-check"></i><b>12.9</b> Series Modelling</a></li>
<li class="chapter" data-level="12.10" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#outlier-detection-terror"><i class="fa fa-check"></i><b>12.10</b> Outlier detection (TERROR)</a></li>
<li class="chapter" data-level="12.11" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#benchmarking"><i class="fa fa-check"></i><b>12.11</b> Benchmarking</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#specification-setting"><i class="fa fa-check"></i><b>12.11.1</b> Specification setting</a></li>
</ul></li>
<li class="chapter" data-level="12.12" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#direct-indirect-comparison"><i class="fa fa-check"></i><b>12.12</b> Direct-Indirect comparison</a></li>
<li class="chapter" data-level="12.13" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#generatiing-output"><i class="fa fa-check"></i><b>12.13</b> Generatiing Output</a>
<ul>
<li class="chapter" data-level="12.13.1" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#steps"><i class="fa fa-check"></i><b>12.13.1</b> Steps</a></li>
<li class="chapter" data-level="12.13.2" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#output-items"><i class="fa fa-check"></i><b>12.13.2</b> Output items</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>13</b> R packages</a>
<ul>
<li class="chapter" data-level="13.1" data-path="r-packages.html"><a href="r-packages.html#available-functions"><i class="fa fa-check"></i><b>13.1</b> Available functions</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="r-packages.html"><a href="r-packages.html#seasonal-adjustment-3"><i class="fa fa-check"></i><b>13.1.1</b> Seasonal Adjustment</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="r-packages.html"><a href="r-packages.html#interaction-with-gui"><i class="fa fa-check"></i><b>13.2</b> Interaction with GUI</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="plug-ins-for-jdemetra.html"><a href="plug-ins-for-jdemetra.html"><i class="fa fa-check"></i><b>14</b> Plug-ins for JDemetra+</a>
<ul>
<li class="chapter" data-level="14.1" data-path="plug-ins-for-jdemetra.html"><a href="plug-ins-for-jdemetra.html#main-functions"><i class="fa fa-check"></i><b>14.1</b> Main functions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="production.html"><a href="production.html"><i class="fa fa-check"></i><b>15</b> Production</a></li>
<li class="chapter" data-level="16" data-path="tool-selection-issues.html"><a href="tool-selection-issues.html"><i class="fa fa-check"></i><b>16</b> Tool selection issues</a></li>
<li class="chapter" data-level="17" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html"><i class="fa fa-check"></i><b>17</b> Spectral Analysis Principles and Tools</a>
<ul>
<li class="chapter" data-level="17.1" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#overview-3"><i class="fa fa-check"></i><b>17.1</b> Overview</a></li>
<li class="chapter" data-level="17.2" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#periodogram"><i class="fa fa-check"></i><b>17.2</b> Periodogram</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#step-1"><i class="fa fa-check"></i><b>17.2.1</b> Step 1</a></li>
<li class="chapter" data-level="17.2.2" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#step-2"><i class="fa fa-check"></i><b>17.2.2</b> Step 2</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#autoregressive-spectrum-estimation"><i class="fa fa-check"></i><b>17.3</b> Autoregressive spectrum estimation</a></li>
<li class="chapter" data-level="17.4" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#tukey-spectrum-definition"><i class="fa fa-check"></i><b>17.4</b> Tukey Spectrum definition</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#theoretical-spectrum-of-the-arima-model-1"><i class="fa fa-check"></i><b>17.4.1</b> Theoretical spectrum of the ARIMA model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="reg-arima-models.html"><a href="reg-arima-models.html"><i class="fa fa-check"></i><b>18</b> Reg-Arima models</a>
<ul>
<li class="chapter" data-level="18.1" data-path="reg-arima-models.html"><a href="reg-arima-models.html#overview-4"><i class="fa fa-check"></i><b>18.1</b> Overview</a></li>
<li class="chapter" data-level="18.2" data-path="reg-arima-models.html"><a href="reg-arima-models.html#regarima-model"><i class="fa fa-check"></i><b>18.2</b> RegARIMA model</a></li>
<li class="chapter" data-level="18.3" data-path="reg-arima-models.html"><a href="reg-arima-models.html#autocorrelation-function"><i class="fa fa-check"></i><b>18.3</b> Autocorrelation function</a></li>
<li class="chapter" data-level="18.4" data-path="reg-arima-models.html"><a href="reg-arima-models.html#estimation-of-arma-models"><i class="fa fa-check"></i><b>18.4</b> Estimation Of Arma models</a></li>
<li class="chapter" data-level="18.5" data-path="reg-arima-models.html"><a href="reg-arima-models.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>18.5</b> Maximum likelihood estimation</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="reg-arima-models.html"><a href="reg-arima-models.html#likelihood-of-a-multivariate-normal-distribution"><i class="fa fa-check"></i><b>18.5.1</b> Likelihood of a multivariate normal distribution</a></li>
<li class="chapter" data-level="18.5.2" data-path="reg-arima-models.html"><a href="reg-arima-models.html#linear-model-with-gaussian-noises"><i class="fa fa-check"></i><b>18.5.2</b> Linear model with gaussian noises</a></li>
<li class="chapter" data-level="18.5.3" data-path="reg-arima-models.html"><a href="reg-arima-models.html#implementation-3"><i class="fa fa-check"></i><b>18.5.3</b> Implementation</a></li>
<li class="chapter" data-level="18.5.4" data-path="reg-arima-models.html"><a href="reg-arima-models.html#missing-values"><i class="fa fa-check"></i><b>18.5.4</b> Missing values</a></li>
<li class="chapter" data-level="18.5.5" data-path="reg-arima-models.html"><a href="reg-arima-models.html#perfect-collinearity-in-x"><i class="fa fa-check"></i><b>18.5.5</b> Perfect collinearity in X</a></li>
<li class="chapter" data-level="18.5.6" data-path="reg-arima-models.html"><a href="reg-arima-models.html#references-6"><i class="fa fa-check"></i><b>18.5.6</b> References</a></li>
<li class="chapter" data-level="18.5.7" data-path="reg-arima-models.html"><a href="reg-arima-models.html#x-13-implementation"><i class="fa fa-check"></i><b>18.5.7</b> X-13 implementation</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="reg-arima-models.html"><a href="reg-arima-models.html#handling-of-missing-observations-in-regarima-models"><i class="fa fa-check"></i><b>18.6</b> Handling of missing observations in (Reg)ARIMA models</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="reg-arima-models.html"><a href="reg-arima-models.html#skipping-approach"><i class="fa fa-check"></i><b>18.6.1</b> Skipping approach</a></li>
<li class="chapter" data-level="18.6.2" data-path="reg-arima-models.html"><a href="reg-arima-models.html#additive-outlier-approach"><i class="fa fa-check"></i><b>18.6.2</b> Additive outlier approach</a></li>
<li class="chapter" data-level="18.6.3" data-path="reg-arima-models.html"><a href="reg-arima-models.html#references-8"><i class="fa fa-check"></i><b>18.6.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="reg-arima-models.html"><a href="reg-arima-models.html#tests-on-residuals"><i class="fa fa-check"></i><b>18.7</b> Tests on residuals</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="reg-arima-models.html"><a href="reg-arima-models.html#autocorrelation"><i class="fa fa-check"></i><b>18.7.1</b> Autocorrelation</a></li>
<li class="chapter" data-level="18.7.2" data-path="reg-arima-models.html"><a href="reg-arima-models.html#normality"><i class="fa fa-check"></i><b>18.7.2</b> Normality</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="moving-average-based-decomposition.html"><a href="moving-average-based-decomposition.html"><i class="fa fa-check"></i><b>19</b> Moving average based decomposition</a></li>
<li class="chapter" data-level="20" data-path="arima-model-based-decomposition.html"><a href="arima-model-based-decomposition.html"><i class="fa fa-check"></i><b>20</b> Arima Model based decomposition</a></li>
<li class="chapter" data-level="21" data-path="state-space-framework.html"><a href="state-space-framework.html"><i class="fa fa-check"></i><b>21</b> State Space Framework</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">JDemetra+ online documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reg-arima-models" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">Chapter 18</span> Reg-Arima models<a href="reg-arima-models.html#reg-arima-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="overview-4" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> Overview<a href="reg-arima-models.html#overview-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="regarima-model" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> RegARIMA model<a href="reg-arima-models.html#regarima-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>old page might be mixed, objective
* in champ 4 on SA, inte pre-adj section: priciples, purpose, results
* here all the technical non algo specific details
* differences (none left ?) between Ts and ReGarima</p>
<p>The primary aim of seasonal adjustment is to remove the unobservable
seasonal component from the observed series. The decomposition routines
implemented in the seasonal adjustment methods make specific assumptions
concerning the input series. One of the crucial assumptions is that the
input series is stochastic, i.e. it is clean of deterministic effects.
Another important limitation derives from the symmetric linear filter
used in TRAMO-SEATS and X-13ARIMA-SEATS. A symmetric linear filter
cannot be applied to the first and last observations with the same set
of weights as for the central observations<a href="#fn78" class="footnote-ref" id="fnref78"><sup>78</sup></a>. Therefore, for the most
recent observations these filters provide estimates that are subject to
revisions.</p>
<p>To overcome these constrains both seasonal adjustment methods discussed
here include a modelling step that aims to analyse the time series
development and provide a better input for decomposition purposes. The
tool that is frequently used for this purpose is the ARIMA model, as
discussed by BOX, G.E.P., and JENKINS, G.M. (1970). However, time series
are often affected by the outliers, other deterministic effects and
missing observations. The presence of these effects is not in line with
the ARIMA model assumptions. The presence of outliers and other
deterministic effects impede the identification of an optimal ARIMA
model due to the important bias in the estimation of parameters of
<a href="../theory/ACF_and_PACF.html">sample autocorrelation functions</a> (both global and partial)<a href="#fn79" class="footnote-ref" id="fnref79"><sup>79</sup></a>.
Therefore, the original series need to be corrected for any
deterministic effects and missing observations. This process is called
linearisation and results in the stochastic series that can be modelled
by ARIMA.</p>
<p>For this purpose both TRAMO and RegARIMA use regression models with
ARIMA errors. With these models TRAMO and RegARIMA also produce
forecasts.</p>
<p><span class="math inline">\(z_{t} = y_{t}\mathbf{\beta} + x_{t}\)</span>, <span class="math display">\[1\]</span> <!--- \[7.5\] --></p>
<p>where:</p>
<p><span class="math inline">\(z_{t}\)</span> is the original series;</p>
<p><span class="math inline">\(\mathbf{\beta} = (\beta_{1},\ldots,\beta_{n})\)</span> – a vector of
regression coefficients;</p>
<p><span class="math inline">\(y_{t} = (y_{1t},\ldots,y_{\text{nt}})\)</span> – <span class="math inline">\(\text{n}\)</span> regression
variables (the trading day variables, the leap year effect, outliers,
the Easter effect, ramps, intervention variables, user-defined
variables);</p>
<p><span class="math inline">\(x_{t}\ \)</span>– a disturbance that follows the general ARIMA process:
<span class="math inline">\(\phi\left( B \right)\delta\left( B \right)x_{t} = \theta(B)a_{t}\)</span>;
<span class="math inline">\(\phi\left( B \right)\)</span>,<span class="math inline">\(\ \theta(B)\)</span> and <span class="math inline">\(\delta\left( B \right)\)</span> are
the finite polynomials in <span class="math inline">\(B\)</span>; <span class="math inline">\(a_{t}\)</span> is a white-noise variable with
zero mean and a constant variance.</p>
<p>The polynomial <span class="math inline">\(\phi\left( B \right)\)</span> is a stationary autoregressive
(AR) polynomial in <span class="math inline">\(B\)</span>, which is a product of the stationary regular AR
polynomial in <span class="math inline">\(B\)</span> and the stationary seasonal polynomial
in <span class="math inline">\(\text{B}^{s}\)</span>:<a href="#fn80" class="footnote-ref" id="fnref80"><sup>80</sup></a></p>
<p><span class="math display">\[\phi\left( B \right) = \phi_{p}\left( B \right)\Phi_{p_{s}}\left( B^{s} \right) = (1 + \phi_{1}B + \ldots + \phi_{p}B^{p})(1 + \Phi_{1}B^{s} + \ldots + \Phi_{p_{s}}B^{p_{s}s})\]</span> <span class="math display">\[2\]</span> <!--- \[7.6\] --></p>
<p>where:</p>
<p><span class="math inline">\(\text{p}\)</span> – the number of regular AR terms, (in
JDemetra+<span class="math inline">\(\ \ p \leq 3)\)</span>;</p>
<p><span class="math inline">\(p_{s}\)</span> – the number of seasonal AR terms, (in
JDemetra+ <span class="math inline">\(p_{s} \leq 1)\)</span>;</p>
<p><span class="math inline">\(\text{s}\)</span> – the number of observations per year (frequency of the
time series).</p>
<p>The polynomial <span class="math inline">\(\theta(B)\)</span> is an invertible moving average (MA)
polynomial in <span class="math inline">\(B\)</span>, which is a product of the invertible regular MA
polynomial in <span class="math inline">\(B\)</span> and the invertible seasonal MA polynomial
in <span class="math inline">\(\text{B}\)</span>:</p>
<p><span class="math inline">\(\theta\left( B \right) = \theta_{q}\left( B \right)\Theta_{q_{s}}\left( B^{s} \right) = (1 + \theta_{1}B + \ldots + \theta_{q}B^{q})(1 + \Theta_{1}B^{s} + \ldots + \Theta_{q_{s}}B^{q_{s}s})\)</span>, <span class="math display">\[3\]</span><!--- \[7.7\] --></p>
<p>where:</p>
<p><span class="math inline">\(q\)</span> – the number of regular MA terms, (<span class="math inline">\(q \leq 3)\)</span>;</p>
<p><span class="math inline">\(q_{s}\)</span> – the number of seasonal MA terms, (<span class="math inline">\(q_{s} \leq 1)\)</span>.</p>
<p>An MA polynomial (1+<span class="math inline">\(\theta_{1}B + \ldots + \theta_{q}B^{q})\ \)</span>is
invertible if all its roots lie outside the unit circle, i.e. their
modulus is greater than 1. When invertible an MA process,
<span class="math inline">\(x_{t} = \theta\left( B \right)a_{t},\)</span> can be expressed as</p>
<p>An AR process of infinite order, <span class="math inline">\(\pi\left( B \right)x_{t} = a_{t}\)</span>,
where , <span class="math inline">\(\pi\left( B \right) = \pi_{0} + \pi_{1}B + \ldots\)</span> <a href="#fn81" class="footnote-ref" id="fnref81"><sup>81</sup></a></p>
<p>The polynomial <span class="math inline">\(\delta\left( B \right)\)</span> is the non-stationary AR
polynomial in <span class="math inline">\(B\)</span> (unit roots):</p>
<p><span class="math inline">\(\delta\left( B \right) = {(1 - B)}^{d}{(1 - B^{s})}^{d_{s}}\)</span>, <span class="math display">\[4\]</span><!---\[7.8\]--></p>
<p>where:</p>
<p><span class="math inline">\(d\)</span> – regular differencing order, (<span class="math inline">\(d \leq 1)\)</span>;</p>
<p><span class="math inline">\(d_{s}\ \)</span>– seasonal differencing order, (<span class="math inline">\(d_{s} \leq 1)\)</span>.</p>
<p>JDemetra+ uses notation: <span class="math inline">\(P,\ D,\ Q,BP,\ BD,\ BQ\)</span> instead of,
respectively:<span class="math inline">\(\ p,\ d,q,p_{s},\ d_{s},\ q_{s}\)</span>. Therefore, the structure
of the ARIMA<span class="math inline">\(\ (p,\ d,\ q)(P,\ D,\ Q)\)</span> model is denoted in JDemetra+ as
ARIMA <span class="math inline">\((P,\ D,\ Q)(BP,\ BD,\ BQ)\)</span>.</p>
<p>Both TRAMO and X-12-ARIMA allows for an automatic identification of an
ARIMA model extended for the regression variables. The procedure
includes a test for logarithmic transformation (so-called the test for
the log-level specification), selection of the ARIMA model structure and
regressors. The estimated deterministic effects are removed from the
time series to improve the estimation of the time series components.
Forecasts produced by the ARIMA model provide an input for the linear
filters used in the decomposition step. In summary, the application of
an ARIMA model to the original series vastly improves the quality and
stability of the estimated components. The details of the estimation
procedure of the ARIMA model with regression variables are presented in
the later in this section.</p>
<p>Among the deterministic effects one can distinguish between the calendar
effects and outliers. The calendar effects are discussed in the <a href="../theory/Calendars.html">Calendar effects</a> section. The
impact of different types of outliers on time series is illustrated with
several examples by FRANSES, P.H. (1998) For example, it was explained
that additive outliers, which are described later in this section, yield
large values of skewness and kurtosis, and hence failure of a normality
test. They also increase the standard error of the estimation
parameters. This effect is especially prominent when the size of the
outlier is considerable.</p>
<p>KAISER, R., and MARAVALL, A. (1999) express the impact of the outliers
on the observed series as:<a href="#fn82" class="footnote-ref" id="fnref82"><sup>82</sup></a></p>
<p><span class="math inline">\(y_{t}^{*} = \sum_{j = 1}^{k}\xi_{j}\left( B \right)\omega_{j}I_{t}^{\left( \tau_{j} \right)} + y_{t}\)</span>, <span class="math display">\[5\]</span> <!---\[7.9\]--></p>
<p>where:</p>
<p><span class="math inline">\(y_{t}^{*}\)</span> – an observed time series;</p>
<p><span class="math inline">\(y_{t}\)</span> – a series that follows the ARIMA model;</p>
<p><span class="math inline">\(\omega_{j}\)</span> – an initial impact of the outlier at time
<span class="math inline">\({t = \tau}_{j}\)</span>;</p>
<p><span class="math inline">\(I_{t}^{\left( \tau_{j} \right)}\)</span> – an indicator variable such that is
1 for <span class="math inline">\({t = \tau}_{j}\)</span> and 0 otherwise;</p>
<p><span class="math inline">\(\xi_{j}\left( B \right)\)</span> – an expression that determines the dynamics
of the outlier occurring at time <span class="math inline">\({t = \tau}_{j}\)</span>;</p>
<p><span class="math inline">\(B\)</span> – a backshift operator (i.e. <span class="math inline">\(B^{k}X_{t} = X_{t - k}\)</span>).</p>
<p>The optimal choice of regression variables (and/or intervention
variables) requires knowledge from the user about the time series being
modelled<a href="#fn83" class="footnote-ref" id="fnref83"><sup>83</sup></a>. On the contrary, outliers, frequently used in modelling
seasonal economic time series, can be automatically detected by
JDemetra+ (see <a href="../reference-manual/modelling-spec-tramo.html">Specifiations - TRAMO</a> section for TRAMO and <a href="../reference-manual/modelling-spec-arima.html">Specifiations - ARIMA</a> section for RegARIMA). The
procedure described in GÓMEZ, V., and MARAVALL, A. (2001a) identifies
the ARIMA model structure in the presence of deterministic effects.
Therefore, the number of identified outliers may depend on the ARIMA
model estimated on the series.</p>
<p>The types of outliers that can be automatically identified and estimated
by JDemetra+ without any user intervention are:</p>
<ul>
<li>Additive Outlier (AO) – a point outlier which occurs at a given
time <span class="math inline">\(t_0\)</span>. For the additive outlier
<span class="math inline">\(\xi_{j}( B) = 1\)</span>, which results in the regression
variable:</li>
</ul>
<p><span class="math display">\[
  AO_{t}^{t_{0}} =
  \begin{cases}   
  1  \text{ for }  t = t_{0} \\\\                              
  0  \text{ for }  t \neq t_{0}                            
  \end{cases}
  \]</span>; <span class="math display">\[6\]</span> <!---\[7.10\]--></p>
<ul>
<li>Level shift (LS) – a variable for a constant level shift beginning
at the given time <span class="math inline">\(t_{0}\)</span>. For the level shift
<span class="math inline">\(\xi_{j}\left( B \right) = \frac{1}{1 - B}\)</span>, which results in the
regression variable:</li>
</ul>
<p><span class="math display">\[
  LS_{t}^{t_{0}} =
  \begin{cases}   
  -1  \text{ for }  t &lt; t_{0} \\\\                              
  0  \text{ for }  t \geq t_{0}                            
  \end{cases}
  \]</span>; <span class="math display">\[7\]</span> <!---\[7.11\]--></p>
<ul>
<li>Temporary change<a href="#fn84" class="footnote-ref" id="fnref84"><sup>84</sup></a> (TC) – a variable for an effect on the given
time <span class="math inline">\(t_{0}\)</span> that decays exponentially over the following
periods. For the temporary change
<span class="math inline">\(\xi_{j}\left( B \right) = \frac{1}{1 - \delta B}\)</span>, which results
in the regression variable:</li>
</ul>
<p><span class="math display">\[
  TC_{t}^{t_{0}} =
  \begin{cases}   
  0  \text{ for }  t &lt; t_{0} \\\\                              
  \alpha^{t - t_{0}}  \text{ for }  t \geq t_{0}                            
  \end{cases}
  \]</span>; <span class="math display">\[8\]</span><!---\[7.12\]--></p>
<blockquote>
<p>where <span class="math inline">\(\alpha\)</span> is a rate of decay back to the previous level
<span class="math inline">\((0 &lt; \alpha &lt; 1)\)</span>.</p>
</blockquote>
<ul>
<li>Seasonal outliers (SO) – a variable that captures an abrupt change
in the seasonal pattern on the given date <span class="math inline">\(t_{0}\ \)</span>and maintains
the level of the series with a contrasting change spread over the
remaining periods. It is modelled by the regression variable:</li>
</ul>
<p><span class="math display">\[
  SO_{t}^{t_{0}} =
  \begin{cases}   
  0  \text{ for }  t &lt; t_{0} \\\\                              
  1  \text{ for }  t \geq t_{0}, \text{$t$ same month/quarter as $t_{0}$}   \\\\                    \frac{- 1}{(s - 1)} \text{ otherwise}       
  \end{cases}
  \]</span>; <span class="math display">\[9\]</span> <!---\[7.13\]--></p>
<p>where <span class="math inline">\(s\)</span> is a frequency of the time series (<span class="math inline">\(s = 12\ \)</span>for a monthly
time series, <span class="math inline">\(s = 4\ \)</span>for a quarterly time series).</p>
<p>The shapes generated by the formulas given above are presented in the figure below.</p>
<div class="figure">
<img src="All_images/UG_A_image1.png" alt="" />
<p class="caption">Text</p>
</div>
<p><strong>Pre-defined outliers built in to JDemetra+</strong></p>
<p>Within the RegARIMA model it can be also tested if a series of level
shifts cancels out to form a temporary level change effect, which is a
permanent level shift spanned between two given dates. It is modelled by
the regression variable:</p>
<p><span class="math display">\[
  TLS_{t}^{ {(t}_{0}{,\ t}_{1})} =
  \begin{cases}   
  0  \text{ for }  t &lt; t_{0} \\\\                              
  1  \text{ for }  t_{1} \geq t \geq t_{0}   \\\\                    
  0 \text{ for } t &gt; t_{1}       
  \end{cases}
  \]</span>; <span class="math display">\[10\]</span><!---\[7.14\]--></p>
<p>JDemetra+ also identifies other pre-defined regression variables, for
which a necessary input, such as location and process that generates the
variable, is provided by the user. This group includes:</p>
<ul>
<li>Ramp – a variable for a linear increase or decrease in the level of
the series over a specified time interval <span class="math inline">\(t_{0}\)</span> to<span class="math inline">\(\ t_{1}\)</span>. It is
modelled by a regression variable:</li>
</ul>
<p><span class="math display">\[
  RP_{t}^{ {(t}_{0}{,\ t}_{1})} =
  \begin{cases}   
-1 \text{ for } t \leq t_{0} \\\\                              
-\frac{t - t_{0}}{t_{1} - t_{0}} - 1 \text{ for } t_{0} &lt; t &lt; t_{1}   \\\\    0 \text{ for } t \geq t_{1}       
  \end{cases}
  \]</span>; <span class="math display">\[11\]</span> <!---\[7.15\]--></p>
<p>Intervention variables which are combinations of five basic structures<a href="#fn85" class="footnote-ref" id="fnref85"><sup>85</sup></a>:</p>
<!-- -->
<ul>
<li><p>dummy variables<a href="#fn86" class="footnote-ref" id="fnref86"><sup>86</sup></a>;</p></li>
<li><p>any possible sequence of ones and zeros;</p></li>
<li><p><span class="math inline">\(\frac{1}{(1 - \delta B)}\)</span>, <span class="math inline">\((0 &lt; \delta \leq 1)\)</span>;</p></li>
<li><p><span class="math inline">\(\frac{1}{(1 - \delta_{s}B^{s})}\)</span>, <span class="math inline">\((0 &lt; \delta_{s} \leq 1)\)</span>;</p></li>
<li><p><span class="math inline">\(\frac{1}{(1 - B)(1 - B^{s})}\)</span>;</p></li>
</ul>
<p>where <span class="math inline">\(s\)</span> is frequency of the time series (<span class="math inline">\(s = 12\ \)</span>for a monthly time
series, <span class="math inline">\(s = 4\ \)</span>for a quarterly time series).</p>
<p>The structures considered by intervention variables allow for generation
of all pre-defined outliers described by <span class="math display">\[6\]</span> – <span class="math display">\[11\]</span>, as well
as some more sophisticated effects. An example can be a level shift
effect reached after a sequence of damped overshootings and
undershootings, presented in the figure below and denoted there as IV. Another
example of an outlier that can be created with intervention variables is
a pure seasonal outlier (<span class="math inline">\(PSO)\)</span>, which, in contrast to the seasonal
outlier described above, does not affect the trend. The set of pure
seasonal outliers is used to model the seasonal change of regime
(<span class="math inline">\(\text{SCR}\)</span>) effect, which describes a sudden and sustained change in
the seasonal pattern affecting from <span class="math inline">\(t_{0}\)</span> (possibly) all seasons of
the series. It is defined as:</p>
<p><span class="math display">\[
  SCR_{i,j} =
  \begin{cases}   
1 \text{ for } t \epsilon j \text{ and } t &lt; t_{0} \\\\                    
0 \text{ for } t \notin j \text{ or } t \geq t_{0} \\\\    
-1 \text{ for } t \epsilon s \text{ and } t &lt; t_{0}       
  \end{cases}
  \]</span>; <span class="math display">\[12\]</span><!---\[7.16\]--></p>
<p>where <span class="math inline">\(j = 1,\ldots s - 1\)</span>.</p>
<div class="figure">
<img src="All_images/UG_A_image2.png" alt="" />
<p class="caption">Text</p>
</div>
<p><strong>Examples of intervention variables</strong></p>
<div id="automatic-model-identification-procedure-in-tramo" class="section level4 hasAnchor" number="18.2.0.1">
<h4><span class="header-section-number">18.2.0.1</span> Automatic model identification procedure in TRAMO<a href="reg-arima-models.html#automatic-model-identification-procedure-in-tramo" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>An algorithm for Automatic Model Identification in the Presence of
Outliers (AMI) implemented in TRAMO is based on TSAY, C. (1986) and
CHEN, B.-C., and LIU, L.-M. (1993) with some modifications (see GÓMEZ,
V., and MARAVALL, A. (2001)). It iterates between two stages: the first
is automatic outlier detection and correction and the second automatic
model identification. The parameters of the AMI procedure are described
in the <a href="../reference-manual/modelling-spec-arima.html">Specifiations - ARIMA</a> section. Unless the parameters are set by the user the program runs
with the default values.</p>
<p>The algorithm starts with the identification of the default model and
pre-testing procedure, where on the first step a test for a log-level
specification is performed. It is based on the maximum likelihood
estimation of the parameter <span class="math inline">\(\lambda\)</span> in the Box-Cox transformation,
which is a power transformation such that the transformed values of the
time series <span class="math inline">\(y\ \)</span>are a monotonic function of the observations, i.e.
<span class="math display">\[
  y^{\alpha} =
  \begin{cases}   
\frac{\left( y_{i}^{\alpha} - 1 \right)}{\lambda}, \lambda \neq 0 \\\\       \log{y_{i}^{\alpha}, \lambda = 0}       
  \end{cases}
  \]</span>;</p>
<p>First, two Airline models (i.e. ARIMA(0,1,1)(0,1,1)) with a mean) are fitted to the time series: one in logs
(<span class="math inline">\(\lambda = 0\)</span>), other without logs (<span class="math inline">\(\lambda = 1\)</span>). The test compares
the sum of squares of the model without logs with the sum of squares
multiplied by the square of the geometric mean of the (regularly and
seasonally) differenced series in the case of the model in logs. Logs
are taken in the case this last function is the minimum<a href="#fn87" class="footnote-ref" id="fnref87"><sup>87</sup></a>. By
default, both TRAMO and X-12-ARIMA have a slight bias towards the log
transformation.</p>
<p>Next, the test for calendar effects is performed with regressions using
the default model for the noise and, if the model is subsequently
changed, the test is redone. For seasonal series the default model is
the Airline model (ARIMA (0,1,1)(0,1,1)) while for the non-seasonal
series ARIMA (0,1,1)(0,0,0) with a constant term is used. The default
model, which is used as a benchmark model at some next steps of AMI, is
determined by the result of the pre-test for possible presence of
seasonality.</p>
<p>Once these pre-tests have been completed, the original series is
corrected for all pre-specified outliers and regression effects provided
by the user, if any. Next, the order of the differencing
polynomial <span class="math inline">\(\text{δ}\left( B \right)\)</span>­ that contains the unit roots is
identified and it is decided whether to specify a mean for the series or
not. The identification of the ARMA model, i.e. the order of
<span class="math inline">\(\phi\left( B \right)\ \)</span>and <span class="math inline">\(\text{θ}\left( B \right)\ \)</span> ­is performed
using the Hannan and Rissanen method by the means of minimising the
Bayesian information criterion with some constraints aimed at increasing
the parsimony and favouring balanced models<a href="#fn88" class="footnote-ref" id="fnref88"><sup>88</sup></a>. This procedure
produces the initial values of the ARIMA model parameters. The search is
done sequentially: for the fixed regular polynomials, the seasonal ones
are obtained, and vice versa. When the estimated roots of the AR and MA
processes are close to each other, <a href="../theory/SA_lin.html#cancellation-of-ar-and-ma-factors">the order of the ARIMA model can be
reduced</a>.
The identification and estimation of the model is carried
out using Exact Maximum Likelihood (EML) or the Unconditional Least
Squares method.</p>
<p>If the calendar effects were identified in the default model, they are
included in a new ARIMA model provided that these effects are
significant for this model. The estimated residuals from the modified
ARIMA model with fixed parameters and the median absolute deviation of
the standard deviation of these residuals are used in the outlier
detection procedure. For each observation, <span class="math inline">\(t\)</span>-tests are computed for
all types of outlier considered in the automatic procedure (AO, TC, LS,
SO), following the procedure proposed in CHEN, B.-C., and LIU, L.-M.
(1993). The program compares<span class="math inline">\(\text{t}\)</span>-statistics to a critical value
determined by the series length. If there are outliers, for which the
absolute <span class="math inline">\(t\)</span>-values are greater than a critical value, the one with the
greatest absolute<span class="math inline">\(\text{t}\)</span>-value is selected. After correcting for
the identified outlier, the process is started again to test if there is
another outlier. The procedure is repeated until for none of the
potential outliers, the <span class="math inline">\(t\)</span>-statistic exceeds the critical value. If
outliers are detected, then a multiple regression is performed using the
Kalman filter and the <a href="../theory/SA_lin.html#least-squares-estimation-by-means-of-the-qr-decomposition">QR algorithm</a>
to avoid (as much as possible)
masking effects (i.e. detecting spurious outliers) and to correct for
the bias produced in the estimators sequentially obtained<a href="#fn89" class="footnote-ref" id="fnref89"><sup>89</sup></a>. If there
are outliers for which the absolute <span class="math inline">\(t\)</span>-values are greater than the
critical value, the one with the greatest absolute <span class="math inline">\(t\)</span>-value is selected
and the algorithm continues to the estimation of the ARMA model
parameters. Otherwise, the algorithm stops<a href="#fn90" class="footnote-ref" id="fnref90"><sup>90</sup></a>. The estimated residuals
from the final ARIMA model are checked for adequacy against the
estimated residuals produced by the balanced model. The final model
identified by the AMI procedure must show some improvement over the
default model in these residual diagnostics; otherwise, the program will
accept the default model<a href="#fn91" class="footnote-ref" id="fnref91"><sup>91</sup></a>.</p>
</div>
<div id="automatic-model-identification-procedure-in-regarima" class="section level4 hasAnchor" number="18.2.0.2">
<h4><span class="header-section-number">18.2.0.2</span> Automatic model identification procedure in RegARIMA<a href="reg-arima-models.html#automatic-model-identification-procedure-in-regarima" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The original RegARIMA algorithm developed by the U.S. Census Bureau
includes two automatic model selection procedures: <em>automdl</em> that is
based on TRAMO and <em>pickmdl</em> that originates from X-11-ARIMA<a href="#fn92" class="footnote-ref" id="fnref92"><sup>92</sup></a>. The
algorithm implementation in JDemetra+ for RegARIMA follows the TRAMO
logic. It is very similar to the TRAMO procedure presented in the
previous section, but contains modifications to make use of the
X-13ARIMA-SEATS estimation procedure, which is different from the one
that TRAMO uses<a href="#fn93" class="footnote-ref" id="fnref93"><sup>93</sup></a>. The examples of extensions that are specific to
RegARIMA only are: special treatment of the leap year effect in the
multiplicative model, automatic detection of the length of the Easter
effect<a href="#fn94" class="footnote-ref" id="fnref94"><sup>94</sup></a>, option to reduce a series of level shifts to the temporary
level shift. In comparison with TRAMO, there are also differences in the
values of the default parameters. Besides, by default, RegARIMA does not
favour balanced models. The log/level test in RegARIMA is based on the
<a href="../theory/SA_lin.html#model-selection-criteria">Corrected Akaike Information Criterion (AICC)</a>. Similarly, the
estimation of calendar effects is based on AICC. As a result, the model
selected by RegARIMA can differ from the model that TRAMO would select,
especially in the case of series contaminated with some deterministic
effects and/or those, which are modelled with the mixed ARIMA models.</p>
</div>
<div id="model-selection-criteria" class="section level4 hasAnchor" number="18.2.0.3">
<h4><span class="header-section-number">18.2.0.3</span> Model selection criteria<a href="reg-arima-models.html#model-selection-criteria" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Model selection criteria are statistical tools for selecting the optimal
order of the ARIMA model. The basic idea behind all these criteria is to
obtain as much explanatory power (measured by the value of the
likelihood function) with only a few parameters. The model selection
criteria essentially choose the model with the best fit, as measured by
the likelihood function, and it is a subject to a penalty term, to
prevent over-fitting that increases with the number of parameters in the
model.<a href="#fn95" class="footnote-ref" id="fnref95"><sup>95</sup></a> Some of the most well-known information criteria are: Akaike
Information Criterion (AIC)<a href="#fn96" class="footnote-ref" id="fnref96"><sup>96</sup></a>, Corrected Akaike Information Criterion
(AICC)<a href="#fn97" class="footnote-ref" id="fnref97"><sup>97</sup></a>, HQ Information Criterion (HannanQuinn)<a href="#fn98" class="footnote-ref" id="fnref98"><sup>98</sup></a> and
Schwarz-Bayes Information Criterion (BIC)<a href="#fn99" class="footnote-ref" id="fnref99"><sup>99</sup></a>.</p>
<p>The formulae for the model selection criteria used by JDemetra+ are:</p>
<p><span class="math display">\[
  AIC_{N} = -2L_{N} + {2n}_{p}
  \]</span> <span class="math display">\[13\]</span><!---\[7.17\]--></p>
<p><span class="math display">\[
AICC_{N} = - 2L_{N} + 2n_{p}\left( 1 - \frac{n_{p} + 1}{N} \right)^{- 1}
\]</span> <span class="math display">\[14\]</span><!---\[7.18\]--></p>
<p><span class="math display">\[
HQ_{N} = - 2L_{N} + 2n_{p}\text{ln(ln(N))}
\]</span> <span class="math display">\[15\]</span><!---\[7.19\]--></p>
<p><span class="math display">\[
BIC_{N} = - 2L_{N} + n_{p}\text{logN}
\]</span> <span class="math display">\[16\]</span><!---\[7.20\]--></p>
<p>where:</p>
<p><span class="math inline">\(\text{N}\)</span>– a number of observations in time series;</p>
<p><span class="math inline">\(n_{p}\)</span> – a number of estimate parameters;</p>
<p><span class="math inline">\(L_{N}\)</span> – a loglikelihood function.</p>
<p>For each model selection criteria the model with the smaller value is
preferred. As it can be shown that AIC is biased for small samples, it
is often replaced by AICC. To choose the ARIMA model parameters the
original RegARIMA uses AICC while TRAMO uses BIC with some constraints
aimed at increasing the parsimony and favouring balanced models. The
automatic model identification methods implemented in JDemetra+ mostly
use BIC, however other criteria are used as well. It should be noted
that the BIC criterion imposes a greater penalty term than AIC and HQ,
so that BIC tends to select simpler models than those chosen by AIC. The
difference between both criteria can be huge if <span class="math inline">\(N\)</span> is large<a href="#fn100" class="footnote-ref" id="fnref100"><sup>100</sup></a>.</p>
</div>
<div id="hannan-rissanen-algorithm" class="section level4 hasAnchor" number="18.2.0.4">
<h4><span class="header-section-number">18.2.0.4</span> Hannan-Rissanen algorithm<a href="reg-arima-models.html#hannan-rissanen-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Hannan-Rissanen algorithm<a href="#fn101" class="footnote-ref" id="fnref101"><sup>101</sup></a> is a penalty function method based on
the BIC criterion, where the estimates of the ARMA model parameters are
computed by means of a linear regression. The Hannan-Rissanen procedure
operates on a stationary transformation of the original series,
therefore only AR and MA parameters are being identified.</p>
<p>In the first step, a high-order<span class="math inline">\(\ AR(m)\)</span>, where <span class="math inline">\(m &gt; max(p,q)\)</span>, model is
fitted to the time series <span class="math inline">\(X_{t}\)</span>. The maximum order of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> is
given a-priori. In JDemetra+ it is equal to 3 for both <span class="math inline">\(p\)</span> and
<span class="math inline">\(q\)</span>. The residuals <span class="math display">\[\widehat{a}_{k}\]</span> from this model are used
to provide estimates of the innovations in the ARMA model <span class="math inline">\(a_{t}\)</span>:</p>
<p><span class="math display">\[a_{t} = X_{t} - \sum_{k = 1}^{m}{\widehat{a}_{k}X}_{t - k}\]</span> <span class="math display">\[17\]</span><!---\[7.21\]--></p>
<p>In the second step the parameters <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> of the ARMA model are
estimated using a least squares linear regression of <span class="math inline">\(X_{t}\)</span> onto
<span class="math inline">\(X_{t - 1},\ldots X_{t - p},a_{t - 1},\ldots a_{t - q}\)</span> for a
combination of values <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. The first step of the procedure is
skipped if the ARMA model fitted in the second step includes only an
autoregressive part.</p>
<p>Finally, the Hannan-Rissanen algorithm selects a pair of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>
values for which <span class="math inline">\(BIC_{p,q}\)</span> is the smallest. <span class="math inline">\(BIC_{p,q}\)</span>
is defined as:</p>
<p><span class="math display">\[\text{BIC}_{p,q} = \log\left( \sigma_{p,q}^{2} \right) + \frac{\left( p + q \right)\log\left( n - d \right)}{n - d}\]</span> <span class="math display">\[18\]</span><!---\[7.22\]--></p>
<p>where:</p>
<p><span class="math inline">\(\sigma_{p,q}^{2}\)</span> is the maximum likelihood estimator of <span class="math inline">\(\sigma^{2}\)</span>;</p>
<p><span class="math inline">\(n - d\ \)</span>is the number of series in the (regularly and/or) seasonally
differenced series.</p>
<p>The advantage of the Hannan-Rissanen algorithm is the speed of
computation in comparison with an exact likelihood estimation.</p>
</div>
<div id="initial-values-for-arima-model-estimation" class="section level4 hasAnchor" number="18.2.0.5">
<h4><span class="header-section-number">18.2.0.5</span> Initial values for ARIMA model estimation<a href="reg-arima-models.html#initial-values-for-arima-model-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>By default, the initial parameter value in X-13ARIMA-SEATS is 0.1 for
all AR and MA parameters. For the majority of time series this default
value seems to be appropriate. Introducing better initial values (as
might be obtained, e.g., by first fitting the model using conditional
likelihood) could slightly speed up a convergence. Users are allowed to
introduce manually initial values for AR and MA parameters that are then
used to start the iterative likelihood maximization. This is rarely
necessary, and, in general, not recommended. A possible exception to
this occurs if the initial estimates that are likely to be extremely
accurate are already available, such as when one is re-estimating a
model with a small amount of new data added to a time series. However,
the main reason for specifying initial parameter values is to deal with
convergence problems that may arise in difficult estimation
situations<a href="#fn102" class="footnote-ref" id="fnref102"><sup>102</sup></a>.</p>
</div>
<div id="cancellation-of-ar-and-ma-factors" class="section level4 hasAnchor" number="18.2.0.6">
<h4><span class="header-section-number">18.2.0.6</span> Cancellation of AR and MA factors<a href="reg-arima-models.html#cancellation-of-ar-and-ma-factors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A cancellation issue consists in cancelling some factors on both sides
of the ARIMA model. This problem concerns the mixed ARIMA
<span class="math inline">\((p,d,q)(P,D,Q)\)</span> models (i.e. <span class="math inline">\(p &gt; 0\ \)</span>and<span class="math inline">\(\ q &gt; 0\)</span>, or <span class="math inline">\(P &gt; 0\)</span> and
<span class="math inline">\(Q &gt; 0\)</span>). For example, a cancellation problem occurs with ARMA (1,1)
model, <span class="math inline">\(\left( 1 - \phi B \right)z_{t} = (1 - \theta B)a_{t}\)</span> when
<span class="math inline">\(\phi = \theta\ \)</span>as then model is simply of the form: <span class="math inline">\(z_{t} = a_{t}\)</span>.
Such model causes problems with convergence of the nonlinear estimation.
For this reason the X-13ARIMA-SEATS and TRAMO-SEATS programs deal with a
cancellation problem by computing zeros of the AR and MA polynomials. As
the cancellation does not need to be exact, the cancellation limit can
be provided by the user<a href="#fn103" class="footnote-ref" id="fnref103"><sup>103</sup></a>.</p>
</div>
<div id="least-squares-estimation-by-means-of-the-qr-decomposition" class="section level4 hasAnchor" number="18.2.0.7">
<h4><span class="header-section-number">18.2.0.7</span> Least squares estimation by means of the QR decomposition<a href="reg-arima-models.html#least-squares-estimation-by-means-of-the-qr-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We consider the regression model:</p>
<p><span class="math inline">\(y = X\beta + \varepsilon\)</span> <span class="math display">\[19\]</span><!---\[7.23\]--></p>
<p>The least squares problem consists in minimizing the quantity
<span class="math inline">\(\left\| X\beta - y \right\|^{2}\)</span>.</p>
<p>Provided that the regression variables are independent, it is possible
to find an orthogonal matrix <span class="math inline">\(Q\)</span>, so that <span class="math inline">\(Q \bullet X = \left( \frac{R}{0} \right)\)</span> where <span class="math inline">\(R\)</span> is upper
triangular.</p>
<p>We have now to minimize:</p>
<p><span class="math display">\[\left\| QX\beta - Qy \right\|_{2}^{2} = \left\|                                                  
  \left( \frac{R}{0} \right)                                                                                       
  \ \beta - Qy \right\|_{2}^{2} = \left\| R\beta - a \right\|_{2}^{2} + \left\| b \right\|_{2}^{2}\]</span> <span class="math display">\[20\]</span><!---\[7.24\]--></p>
<p>where <span class="math inline">\(Qy_{0\ldots x - 1} = a\)</span> and
<span class="math inline">\(Qy_{x\ldots n - 1} = b\)</span>.</p>
<p>The minimum of the previous norm is obtained by setting
<span class="math inline">\(\beta = R^{- 1}a\)</span>. In that case
<span class="math inline">\(\left\| R\ \beta - a \right\|_{2}^{2} = 0\)</span>. The residuals obtained by
this procedure are then <span class="math inline">\(b\)</span>, as defined above.</p>
<p>It should be noted that the <span class="math inline">\(\text{QR}\)</span> factorization is not unique, and
that the final residuals also depend on the order of the regression
variables (the columns of <span class="math inline">\(X\)</span>).</p>
</div>
</div>
<div id="autocorrelation-function" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> Autocorrelation function<a href="reg-arima-models.html#autocorrelation-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The correlation is a measure of the strength and the direction of a
linear relationship between two variables. For time series the
correlation can refer to the relation between its observations, e.g.
between the current observation and the observation lagged by a given
number of units. In this case all observations come from one variable,
so similarity between a given time series and a <span class="math inline">\(k\)</span>-lagged version of
itself over successive time intervals is called an autocorrelation.</p>
<p>The autocorrelation coefficient at lag <span class="math inline">\(k\)</span> is defined as:</p>
<p><span class="math display">\[\rho\left( k \right) = \frac{\sum_{t = k + 1}^{n}\left( x_{t} - \overline{x} \right)}{\sum_{t = 1}^{n}\left( x_{t} - \overline{x} \right)^{2}}
\]</span>, <span class="math display">\[1\]</span> <!--- \[7.159\]--></p>
<p>where:</p>
<p><span class="math inline">\(x_{t}\)</span> – time series;</p>
<p><span class="math inline">\(n\)</span> – total number of observations;</p>
<p><span class="math inline">\(\overline{x}\)</span> – mean of the time series.</p>
<p>The set of autocorrelation coefficients <span class="math inline">\((k)\)</span> arranged as a function of
<span class="math inline">\(k\)</span> is the autocorrelation function (ACF). The graphical or numerical
representation of the ACF is called an autocorrelogram.</p>
<div class="figure">
<img src="All_images/UG_A_image20.png" alt="" />
<p class="caption">Text</p>
</div>
<p><strong>Autocorrelation function</strong></p>
<p>The autocorrelation function is a valuable tool for investigating
properties of an empirical time series.<a href="#fn104" class="footnote-ref" id="fnref104"><sup>104</sup></a> The assessment of the order
of an AR process simply from the sample ACF is not straightforward.
While for a first-order process the theoretical ACF decreases
exponentially and the sample function is expected to have the similar
shape, for the higher-order processes the ACF maybe a mixture of damper
exponential or sinusoidal functions, which makes the order of the AR
process difficult to identify.<a href="#fn105" class="footnote-ref" id="fnref105"><sup>105</sup></a> JDemetra+ displays the values of
autocorrelation function for the residuals from the ARIMA model (see
section <a href="..\reference-manual/residuals.html">Residuals</a>). The ACF graph (figure above), presents autocorrelation
coefficients and the confidence intervals. If the autocorrelation
coefficient is in the confidence interval, it is regarded as not
statistically significant. Therefore, the user should focus on the
values where the value of the ACF is outside the confidence interval. In
JDemetra+ the confidence interval is indicated by two grey, horizontal,
dotted lines.</p>
<p><strong>Partial autocorrelation function</strong></p>
<p>The partial autocorrelation is a tool for the identification and
estimation of the ARIMA model. It is defined as the amount of
correlation between two variables that is not explained by their mutual
correlations with a given set of other variables.</p>
<p>Partial autocorrelation at lag <span class="math inline">\(k\)</span> is defined as the autocorrelation
between <span class="math inline">\(x_{t}\)</span> and <span class="math inline">\(x_{t - k}\)</span> that is not accounted for by lags 1
through to <span class="math inline">\(k\)</span>-1, which means that correlations with all the elements up
to lag <span class="math inline">\(k\)</span> are removed. Following this definition, a partial
autocorrelation for lag 1 is equivalent to an autocorrelation.</p>
<p>The partial autocorrelation function (PACF) is the set of partial
autocorrelation coefficients <span class="math inline">\((k)\)</span> arranged as a function
of <span class="math inline">\(k\)</span>. This function can be used to detect the presence of an
autoregressive process in time series and identify the order of this
process. Theoretically, the number of significant lags determines the
order of the autoregressive process.</p>
<div class="figure">
<img src="All_images/UG_A_image21.png" alt="" />
<p class="caption">Text</p>
</div>
<p><strong>Partial autocorrelation function</strong></p>
<p>The PACF graph above, which
is available from the <em>Tools</em><span class="math inline">\(\  \rightarrow \ \)</span><em>Differencing</em> menu
presents partial autocorrelation coefficients and the confidence
intervals (two grey, horizontal, dotted lines). If the partial autocorrelation coefficient is in the
confidence interval, it is regarded as statistically insignificant.
Therefore, the user should focus on the values, for which the absolute value
of the PACF is outside the confidence interval.</p>
</div>
<div id="estimation-of-arma-models" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> Estimation Of Arma models<a href="reg-arima-models.html#estimation-of-arma-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The computation of <a href="../../stats/likelihood/ll.md">exact likelihood</a> requires the evaluation of two main quantities: the determinant of the covariance matrix
and the sum of the squared residuals.
The different algorithms for the computation of the likelihood of ARMA models provides efficient solutions for those two problems.
The quantity
<span class="math display">\[ y&#39; \Omega^-1 y \]</span>
is computed by defining a linear transformation of the observations such that
<span class="math display">\[ y&#39; \Omega^-1 y = \left(y&#39; T&#39; \right) \left(T y \right) \]</span>
An obvious solution will be the use of the inverse of the Cholesky factor of the covariance matrix. However, any transformation
<span class="math display">\[ T\sim m \times n \]</span>
such that
<span class="math display">\[ \Omega^-1 =  T&#39; T \]</span>
might be considered. Note that m can be larger than n (which means that the transformed observations will not be independent).</p>
<p>JD+ provides several routines for estimating the exact likelihood of ARMA models</p>
<table>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Kalman filter</td>
<td>Default</td>
</tr>
<tr class="even">
<td><a href="./ansley.md">Ansley</a></td>
<td>Large regression models</td>
</tr>
<tr class="odd">
<td><a href="./x12.md">X12</a></td>
<td>Legacy</td>
</tr>
<tr class="even">
<td>Ljung-Box</td>
<td>Deprecated</td>
</tr>
</tbody>
</table>
</div>
<div id="maximum-likelihood-estimation" class="section level2 hasAnchor" number="18.5">
<h2><span class="header-section-number">18.5</span> Maximum likelihood estimation<a href="reg-arima-models.html#maximum-likelihood-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="likelihood-of-a-multivariate-normal-distribution" class="section level3 hasAnchor" number="18.5.1">
<h3><span class="header-section-number">18.5.1</span> Likelihood of a multivariate normal distribution<a href="reg-arima-models.html#likelihood-of-a-multivariate-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The pdf of a multivariate normal distribution is:</p>
<p><span class="math display">\[p\left( y \right) = \left( 2 \pi \right)^{-\frac{n}{2}} \vert \Sigma \vert ^{-\frac{1}{2}}e^{ {-\frac{1}{2}y&#39; \Sigma ^{-1} y} } \]</span></p>
<p>If we set</p>
<p><span class="math display">\[ y&#39; \Sigma ^{-1} y=u&#39;u \:\: or \:\:  L^{-1}y = u \]</span></p>
<p>the log-likelihood is:</p>
<p><span class="math display">\[ l \left( \theta | y \right) =- \frac{1}{2} \left(n \log{2 \pi}+ \log{|\Sigma |} +u&#39;u\right) \]</span></p>
<p>In most cases, we will use a covariance matrix with a (unknown) scaling factor:</p>
<p><span class="math display">\[ \Sigma = \sigma^2 \Omega \]</span></p>
<p>If we set</p>
<p><span class="math display">\[ L^{-1}y = e , \quad LL&#39; = \Omega\]</span></p>
<p>the log-likelihood can then be written:</p>
<p><span class="math display">\[ l \left(\theta, \sigma | y \right ) = - \frac{1}{2} \left(n \log{2 \pi}+ n \log {\sigma^2} + \log{|\Omega |} + \frac{1}{\sigma ^2} e&#39;e \right) \]</span></p>
<p>The scaling factor can be concentrated out of the likelihood. Its estimator is</p>
<p><span class="math display">\[ \hat{\sigma} ^2 = \frac{e&#39; e}{n} \]</span></p>
<p>so that :</p>
<p><span class="math display">\[ l_c \left( \theta | y \right ) = - \frac{1}{2} \left(n \log{2 \pi} + n\log{\frac{e&#39;e}{n}} + \log{|\Omega |} + n \right) \]</span></p>
<p>or</p>
<p><span class="math display">\[ l_c \left( \theta | y \right ) = - \frac{n}{2} \left(\log{2 \pi}+ 1 - \log {n} + \log{e&#39;e} + \log{|\Omega |^\frac{1}{n}}\right) \]</span></p>
<p>Maximizing $ l_c $ is equivalent to minimizing the deviance</p>
<p><span class="math display">\[ d \left( y | \theta\right ) = e&#39;e |\Omega |^\frac{1}{n} = v&#39;v, \quad where \quad v = \sqrt{ |\Omega |^\frac{1}{n} }\: e\]</span></p>
<p>This last formulation will be used in optimization procedures based on sums of squares (Levenberg-Marquardt and similar algorithms).</p>
</div>
<div id="linear-model-with-gaussian-noises" class="section level3 hasAnchor" number="18.5.2">
<h3><span class="header-section-number">18.5.2</span> Linear model with gaussian noises<a href="reg-arima-models.html#linear-model-with-gaussian-noises" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The likelihood is often computed on a linear model
<span class="math display">\[ y=X\beta + \mu \quad \mu \sim N\left(0, \sigma^2\Omega\right) \]</span></p>
<p>The log-likelihood is then
<span class="math display">\[ l \left(\theta,\beta , \sigma | y \right ) = - \frac{1}{2} \left(n \log{2 \pi}+ n \log {\sigma^2} + \log{|\Omega |} + \frac{1}{\sigma ^2} \left(y-X\beta \right)&#39;\Omega^{-1}\left(y-X\beta \right) \right) \]</span></p>
<p>The maximum likelihood estimator of <span class="math inline">\(\beta\)</span> is</p>
<p><span class="math display">\[ \hat{\beta} = \left( X&#39;\Omega^{-1}X\right)^{-1}X&#39;\Omega^{-1}y \]</span></p>
<p>which is normally distributed with variance
<span class="math display">\[ \sigma^2 \left( X&#39;\Omega^{-1}X\right)^{-1} \]</span></p>
<p>The formulae of the likelihood are still valid, using
<span class="math display">\[ e=L^{-1} \left(y-X\hat\beta \right) \]</span></p>
</div>
<div id="implementation-3" class="section level3 hasAnchor" number="18.5.3">
<h3><span class="header-section-number">18.5.3</span> Implementation<a href="reg-arima-models.html#implementation-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Those representations of the concentrated likelihood are defined in the interfaces <strong><em>demetra.likelihood.ILikelihood</em></strong> and <strong><em>demetra.likelihood.IConcentratedLikelihood</em></strong></p>
<div id="correspondance-between-the-elements-of-the-likelihood-see-formulae-and-the-methods-of-the-classes" class="section level4 hasAnchor" number="18.5.3.1">
<h4><span class="header-section-number">18.5.3.1</span> Correspondance between the elements of the likelihood (see formulae) and the methods of the classes<a href="reg-arima-models.html#correspondance-between-the-elements-of-the-likelihood-see-formulae-and-the-methods-of-the-classes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><span class="math inline">\(n\)</span> : dim()</li>
<li><span class="math inline">\(e&#39;e\)</span> : ssq()</li>
<li><span class="math inline">\(e\)</span> : e()</li>
<li><span class="math inline">\(\log \|\Omega\|\)</span> : logDeterminant()</li>
<li><span class="math inline">\(v\)</span> : v()</li>
<li><span class="math inline">\(\|\Omega\|^{\frac{1}{n}}\)</span> : factor()</li>
</ul>
</div>
</div>
<div id="missing-values" class="section level3 hasAnchor" number="18.5.4">
<h3><span class="header-section-number">18.5.4</span> Missing values<a href="reg-arima-models.html#missing-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Missing values are not taken into account in the likelihood. More especially, when they are estimated by means of additive outliers, all the different elements of the likelihood (dimension, determinantal term, coefficients…) should be adjusted to remove their effect.</p>
</div>
<div id="perfect-collinearity-in-x" class="section level3 hasAnchor" number="18.5.5">
<h3><span class="header-section-number">18.5.5</span> Perfect collinearity in X<a href="reg-arima-models.html#perfect-collinearity-in-x" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the case of perfect collinearity in the linear model, the dimensions of the coefficients and of the related matrices are not modified. However, information related to the redundant variables is set to 0.</p>
</div>
<div id="references-6" class="section level3 hasAnchor" number="18.5.6">
<h3><span class="header-section-number">18.5.6</span> References<a href="reg-arima-models.html#references-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Gomez V. and Maravall A.</em> (1994): “Estimation, Prediction, and Interpolation for Nonstationary Series With the Kalman Filter”, Journal of the American Statistical Association, vol. 89, n° 426, 611-624.</p>
</div>
<div id="x-13-implementation" class="section level3 hasAnchor" number="18.5.7">
<h3><span class="header-section-number">18.5.7</span> X-13 implementation<a href="reg-arima-models.html#x-13-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Estimation of the exact likelihood of an ARMA model</p>
<p>We suppose that
<span class="math display">\[ y_t, \quad 1 \le t \le n \]</span>
follows an ARMA model.</p>
<p>The X12 implementation computes the exact likelihood in two main steps</p>
<div id="overview-5" class="section level4 hasAnchor" number="18.5.7.1">
<h4><span class="header-section-number">18.5.7.1</span> Overview<a href="reg-arima-models.html#overview-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We consider the transformation</p>
<p><span class="math display">\[ z_t = \begin{pmatrix} z_{1t} \\ z_{2t} \end{pmatrix} = \begin{cases} y_t, &amp; 1 \le t \le p \\ \Phi\left(B\right) y_t, &amp; p \lt t \le n\end{cases}\]</span></p>
<p>It is obvious that
<span class="math display">\[ p\left(y_t\right) = p\left(z_t\right) \]</span></p>
<p>We will estimate
<span class="math display">\[ p\left(z_t\right) = p\left(z_{2t}\right)  p\left(z_{1t}\right | z_{2t} )\]</span></p>
</div>
<div id="step-1-likelihood-of-a-pure-moving-average-process" class="section level4 hasAnchor" number="18.5.7.2">
<h4><span class="header-section-number">18.5.7.2</span> Step 1: likelihood of a pure moving average process<a href="reg-arima-models.html#step-1-likelihood-of-a-pure-moving-average-process" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[z_{2t}\]</span>
is a pure moving average process. Its exact likelihood is estimated as follows (see [1] for details).
We list below the different steps of the algorithm.</p>
<ul>
<li><p>Compute the conditional least squares residuals by the recursion:
<span class="math display">\[ a_{0t} = \begin{cases} 0,&amp; -q \lt t \leq 0 \\ z_t-\theta_1 a_{0t-1}- \cdots --\theta_q a_{0t-q},&amp;  0 \lt t \leq n  \end{cases} \]</span></p></li>
<li><p>Compute the Pi-Weights of the model. They defines the (n+q x q) matrix</p></li>
</ul>
<p><span class="math display">\[ G = \begin{pmatrix} 1 &amp; 0 &amp; \cdots &amp; 0 \\ \pi_1 &amp; 1 &amp; \cdots &amp; 0 \\ \pi_2 &amp; \pi_1 &amp; \cdots &amp; \vdots\\ \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\ \pi_{n+q-1} &amp; \pi_{n+q-2} &amp; \cdots &amp; \pi_{n} \end{pmatrix} \]</span></p>
<ul>
<li><p>Compute by recursion
<span class="math display">\[ G&#39;a \quad and \quad G&#39;G \]</span></p></li>
<li><p>Compute by Cholesky decomposition
<span class="math display">\[ G&#39;G \hat z_* = G&#39;a \quad and \quad |G&#39;G| \]</span></p></li>
<li><p>Obtain by recursion the exact likelihood residuals
<span class="math display">\[ \Theta\left(B\right)\begin{pmatrix}\hat a_* \\ \hat a_t \end{pmatrix}  = \begin{pmatrix}z_* \\ z_t \end{pmatrix} \]</span></p></li>
</ul>
<p>The processing defines the linear transformation
<span class="math display">\[ T z_t = \begin{pmatrix}\hat a_* \\ \hat a_t \end{pmatrix} \]</span> and the searched determinant.</p>
</div>
<div id="step-2-conditional-distribution-of-the-initial-observations" class="section level4 hasAnchor" number="18.5.7.3">
<h4><span class="header-section-number">18.5.7.3</span> Step 2: conditional distribution of the initial observations<a href="reg-arima-models.html#step-2-conditional-distribution-of-the-initial-observations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[ p\left(z_{1t}\right | z_{2t} ) \]</span>
is easily obtained by considering the join distribution of
<span class="math display">\[ \left( z_{1t}, z_{2t} \right) \sim N \left( 0, \begin{pmatrix} \Sigma_{11} &amp;&amp; \Sigma{12} \\ \Sigma_{21} &amp;&amp; \Sigma{22} \end{pmatrix}\right) \ \]</span></p>
<p>It is distributed as
<span class="math display">\[ N\left( \Sigma_{12} \Sigma_{22}^{-1}v, \Sigma_{11}-\Sigma_{12} \Sigma_{22}^{-1} \Sigma_{21} \right)\]</span></p>
<p><span class="math display">\[= N\left( \Sigma_{12} T&#39;Tv, \Sigma_{11}-\Sigma_{12} T&#39;T\Sigma_{21} \right)\]</span></p>
<p><span class="math display">\[  = N\left( U&#39;Tv, \Sigma_{11}-U&#39;U \right)\]</span></p>
<p>where
* v is obtained by applying the auto-regressive polynomial on the observations
* T is the linear transformation defined in step 1
*
<span class="math display">\[ U = T \Sigma_{21} \]</span></p>
<div id="references-7" class="section level5 hasAnchor" number="18.5.7.3.1">
<h5><span class="header-section-number">18.5.7.3.1</span> References<a href="reg-arima-models.html#references-7" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>[1] <strong><em>Otto M. C., Bell W.R., Burman J.P.</em></strong> (1987), “An Iterative GLS Approach to Maximum Likelihood Estimation of Regression Models with Arima Errors”, Bureau of The Census, SRD Research Report CENSUS/SRD/RR_87/34.</p>
</div>
</div>
</div>
</div>
<div id="handling-of-missing-observations-in-regarima-models" class="section level2 hasAnchor" number="18.6">
<h2><span class="header-section-number">18.6</span> Handling of missing observations in (Reg)ARIMA models<a href="reg-arima-models.html#handling-of-missing-observations-in-regarima-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="skipping-approach" class="section level3 hasAnchor" number="18.6.1">
<h3><span class="header-section-number">18.6.1</span> Skipping approach<a href="reg-arima-models.html#skipping-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="additive-outlier-approach" class="section level3 hasAnchor" number="18.6.2">
<h3><span class="header-section-number">18.6.2</span> Additive outlier approach<a href="reg-arima-models.html#additive-outlier-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="references-8" class="section level3 hasAnchor" number="18.6.3">
<h3><span class="header-section-number">18.6.3</span> References<a href="reg-arima-models.html#references-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>GOMEZ V. , MARAVALL A. AND PEÑA D.</strong> (1999): “<em>Missing observations in ARIMA models: Skipping approach versus additive outlier approach</em>”, Journal of econometrics 88, 341-363.</p>
</div>
</div>
<div id="tests-on-residuals" class="section level2 hasAnchor" number="18.7">
<h2><span class="header-section-number">18.7</span> Tests on residuals<a href="reg-arima-models.html#tests-on-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="autocorrelation" class="section level3 hasAnchor" number="18.7.1">
<h3><span class="header-section-number">18.7.1</span> Autocorrelation<a href="reg-arima-models.html#autocorrelation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="the-durbin-watson-statistic-is-defined-by81" class="section level4 hasAnchor" number="18.7.1.1">
<h4><span class="header-section-number">18.7.1.1</span> The Durbin-Watson statistic is defined by<a href="#fn106" class="footnote-ref" id="fnref106"><sup>106</sup></a>:<a href="reg-arima-models.html#the-durbin-watson-statistic-is-defined-by81" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
d = \frac{\sum_{t = 2}^{N}\left( {\widehat{a}}_{t} - {\widehat{a}}_{t - 1} \right)^{2}}{\sum_{t = 1}^{N}{\widehat{a}}_{t}^{2}}
\]</span></p>
<p>where:</p>
<p><span class="math inline">\({\widehat{a}}_{t}\)</span> : residual from the model.</p>
<p>Since
<span class="math display">\[\sum_{t = 2}^{N}\left( {\widehat{a}}_{t} - {\widehat{a}}_{t - 1} \right)^{2} \cong \ \]</span>2<span class="math display">\[\sum_{t = 1}^{N}{\widehat{a}}_{t}^{2} - 2\sum_{t = 2}^{N}{ {\widehat{a}}_{t}{\widehat{a}}_{t - 1}}\]</span>,
then the approximation <span class="math inline">\(d \cong 2(1 - r_{z,1})\)</span>, where
<span class="math display">\[r_{z,1} = \frac{\sum_{t = 1}^{N}{ {\widehat{a}}_{t}{\widehat{a}}_{t - 1}}}{\sum_{t = 1}^{N}{\widehat{a}}_{t}^{2}}\]</span>
is the autocorrelation coefficient of the residuals at lag 1, is true.</p>
<p>The Durbin-Watson statistics is between 0 and 4. When the model provides
an adequate description of the data, then <span class="math inline">\(r_{z,1}\)</span> should be close to 0
and therefore the Durbin-Watson statistics is close to 2. When the
Durbin–Watson statistic is substantially less than 2, there is evidence
of positive serial correlation, while when it is substantially greater
than 2 it indicates that the successive error terms are, on average,
much different in value from one another, i.e., negatively correlated.</p>
<p>More formally, to test for a positive autocorrelation at
significance level <span class="math inline">\(\alpha\)</span>, the Durbin-Watson statistics is compared to
the lower (<span class="math inline">\(d_{L,\alpha}\ )\ \)</span>and upper (<span class="math inline">\(d_{U,\alpha})\)</span> critical
values:</p>
<ul>
<li><p>If <span class="math inline">\(d &lt; d_{L,\alpha}\)</span> there is statistical evidence that the error terms are positively autocorrelated.</p></li>
<li><p>If <span class="math inline">\(d &gt; d_{U,\alpha}\)</span> there is no statistical evidence that the error terms are positively autocorrelated.</p></li>
<li><p>If <span class="math inline">\(d_{L,\alpha}\)</span> <span class="math inline">\(&lt; d &lt; d_{U,\alpha}\)</span> the test is inconclusive.</p></li>
</ul>
<p>Positive serial correlation is serial correlation in which a positive
error for one observation increases the chances of a positive error for
another observation.</p>
<p>To test for negative autocorrelation at significance<span class="math inline">\(\ \alpha\)</span>, the test
statistic <span class="math inline">\((4 - d)\)</span> is compared to the lower (<span class="math inline">\(d_{L,\alpha}\ )\ \)</span>and
upper (<span class="math inline">\(d_{U,\alpha})\)</span> critical values:</p>
<ul>
<li><p>If <span class="math inline">\(\left( 4 - d \right) &lt; d_{L,\alpha}\)</span> there is statistical evidence that the error terms are negatively autocorrelated.</p></li>
<li><p>If <span class="math inline">\(\left( 4 - d \right) &gt; d_{U,\alpha}\)</span> there is no statistical evidence that the error terms are negatively autocorrelated.</p></li>
<li><p>If <span class="math inline">\(d_{U,\alpha} &lt; \left( 4 - d \right) &lt; d_{U,\alpha}\)</span> the test is inconclusive.</p></li>
</ul>
</div>
<div id="ljung-box-test" class="section level4 hasAnchor" number="18.7.1.2">
<h4><span class="header-section-number">18.7.1.2</span> Ljung-Box test<a href="reg-arima-models.html#ljung-box-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>(described twice: merge)</p>
<p>The Ljung-Box Q-statistics are given by:</p>
<p><span class="math display">\[
  \text{LB}\left( k \right) = n \times (n + 2) \times \sum_{k = 1}^{K}\frac{\rho_{a,k}^{2}}{n - k}
  \]</span>, <span class="math display">\[1\]</span> <!---\[7.144\]      --></p>
<p>where:</p>
<p><span class="math display">\[\rho_{a,k}^{2}\]</span> is the autocorrelation coefficient at lag <span class="math inline">\(k\)</span> of the
residuals <span class="math display">\[{\widehat{a}}_{t}\]</span>.</p>
<p><span class="math inline">\(n\)</span> is the number of terms in differenced series;</p>
<p><span class="math display">\[K\]</span> is the maximum lag being considered, set in JDemetra+ to <span class="math inline">\(24\)</span>
(monthly series) or <span class="math inline">\(8\)</span> (quarterly series).</p>
<p>If the residuals are random (which is the case for residuals from a well
specified model), they will be distributed as <span class="math inline">\(\chi_{(K - m)}^{2}\)</span>,
where <span class="math inline">\(m\)</span> is the number of parameters in the model which has been fitted
to the data.</p>
<p>The Ljung-Box and Box-Pierce tests sometimes fail to reject a poorly
fitting model. Therefore, care should be taken not to accept a model on
a basis of their results. For the description of autocorrelation concept
see section <a href="../theory/ACF_and_PACF.html">Autocorrelation function and partial autocorrelation function</a>.</p>
<p>The Ljung-Box test checks the “overall” randomnes of a time series using a given number of <a href="../../descriptive.md">autocorrelations</a>.<br />
It tests wether any of a group of autocorrelations of a time series are significantly different from 0.</p>
<div id="algorithm" class="section level5 hasAnchor" number="18.7.1.2.1">
<h5><span class="header-section-number">18.7.1.2.1</span> Algorithm<a href="reg-arima-models.html#algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We consider the autocorrelations <span class="math inline">\(\hat\gamma_l, \cdots, \hat\gamma_{l\cdot k}\)</span>. Typically, <span class="math inline">\(l=1\)</span> when testing the independence of the series or <span class="math inline">\(l=freq\)</span> when testing seasonality.</p>
<p>The value of the test is defined by</p>
<p><span class="math display">\[ lb=n \left(n+2\right)\sum_{i=1}^k\frac{\hat\gamma_{i \cdot l}^2}{n-i \cdot l}\]</span></p>
<p>It is asymptotically distributed as a <span class="math inline">\(\chi \left(k\right)\)</span></p>
</div>
<div id="impementation-in-gui" class="section level5 hasAnchor" number="18.7.1.2.2">
<h5><span class="header-section-number">18.7.1.2.2</span> Impementation in GUI<a href="reg-arima-models.html#impementation-in-gui" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="impementation-in-r" class="section level5 hasAnchor" number="18.7.1.2.3">
<h5><span class="header-section-number">18.7.1.2.3</span> Impementation in R<a href="reg-arima-models.html#impementation-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="java-library-1" class="section level5 hasAnchor" number="18.7.1.2.4">
<h5><span class="header-section-number">18.7.1.2.4</span> Java Library<a href="reg-arima-models.html#java-library-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This test is implemented in the class <code>demetra.stats.tests.LjungBoxTest</code></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="reg-arima-models.html#cb1-1" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N<span class="op">=</span><span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-2"><a href="reg-arima-models.html#cb1-2" aria-hidden="true" tabindex="-1"></a>    DataBlock sample<span class="op">=</span>DataBlock<span class="op">.</span><span class="fu">make</span><span class="op">(</span>N<span class="op">);</span></span>
<span id="cb1-3"><a href="reg-arima-models.html#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">Random</span> rnd<span class="op">=</span><span class="kw">new</span> <span class="bu">Random</span><span class="op">();</span></span>
<span id="cb1-4"><a href="reg-arima-models.html#cb1-4" aria-hidden="true" tabindex="-1"></a>    LjungBoxTest lb<span class="op">=</span><span class="kw">new</span> <span class="fu">LjungBoxTest</span><span class="op">(</span>sample<span class="op">);</span></span>
<span id="cb1-5"><a href="reg-arima-models.html#cb1-5" aria-hidden="true" tabindex="-1"></a>    StatisticalTest test <span class="op">=</span> lb</span>
<span id="cb1-6"><a href="reg-arima-models.html#cb1-6" aria-hidden="true" tabindex="-1"></a>             <span class="op">.</span><span class="fu">lag</span><span class="op">(</span><span class="dv">3</span><span class="op">)</span></span>
<span id="cb1-7"><a href="reg-arima-models.html#cb1-7" aria-hidden="true" tabindex="-1"></a>             <span class="op">.</span><span class="fu">autoCorrelationsCount</span><span class="op">(</span><span class="dv">10</span><span class="op">)</span></span>
<span id="cb1-8"><a href="reg-arima-models.html#cb1-8" aria-hidden="true" tabindex="-1"></a>             <span class="op">.</span><span class="fu">build</span><span class="op">();</span></span></code></pre></div>
</div>
</div>
<div id="box-pierce-test" class="section level4 hasAnchor" number="18.7.1.3">
<h4><span class="header-section-number">18.7.1.3</span> Box-Pierce Test<a href="reg-arima-models.html#box-pierce-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>(described twice: merge)</p>
<p>The Box-Pierce Q-statistics are given by:</p>
<p><span class="math display">\[\text{BP}\left( k \right) = n\sum_{k = 1}^{K}\rho_{a,k}^{2}
  \]</span>, <span class="math display">\[1\]</span> <!---\[7.145\]      --></p>
<p>where:</p>
<p><span class="math inline">\(\rho_{a,k}^{2}\)</span> is the autocorrelation coefficient at lag <span class="math inline">\(k\)</span> of the
residuals <span class="math inline">\({\widehat{a}}_{t}\)</span>.</p>
<p><span class="math inline">\(n\)</span> is the number of terms in differenced series;</p>
<p><span class="math inline">\(K\)</span> is the maximum lag being considered, set in JDemetra+ to <span class="math inline">\(24\)</span>
(monthly series) or <span class="math inline">\(8\)</span> (quarterly series).</p>
<p>If the residuals are random (which is the case for residuals from a well
specified model), they will be distributed as <span class="math inline">\(\chi_{(K - m)}^{2}\)</span>
degrees of freedom, where <span class="math inline">\(m\)</span> is the number of parameters in the model
which has been fitted to the data.</p>
<p>The Ljung-Box and Box-Pierce tests sometimes fail to reject a poorly
fitting model. Therefore, care should be taken not to accept a model on
a basis of their results. For the description of autocorrelation concept
see section <a href="../theory/ACF_and_PACF.html">Autocorrelation function and partial autocorrelation function</a>.</p>
<p>Explain difference with Ljung-Box test</p>
<p>The Box-Pierce test checks the “overall” randomnes of a time series using a given number of <a href="../../descriptive.md">autocorrelations</a>.<br />
It tests wether any of a group of autocorrelations of a time series are significantly different from 0.</p>
<div id="statistic" class="section level5 hasAnchor" number="18.7.1.3.1">
<h5><span class="header-section-number">18.7.1.3.1</span> Statistic<a href="reg-arima-models.html#statistic" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We consider the autocorrelations <span class="math inline">\(\hat\gamma_l, \cdots, \hat\gamma_{l\cdot k}\)</span>. Typically, <span class="math inline">\(l=1\)</span> when testing the independence of the series or <span class="math inline">\(l=freq\)</span> when testing seasonality.</p>
<p>The value of the test is defined by</p>
<p><span class="math display">\[ bp=n \sum_{i=1}^k\hat\gamma_{i \cdot l}^2\]</span></p>
<p>It is asymptotically distributed as a <span class="math inline">\(\chi \left(k\right)\)</span></p>
</div>
<div id="impementation-in-gui-1" class="section level5 hasAnchor" number="18.7.1.3.2">
<h5><span class="header-section-number">18.7.1.3.2</span> Impementation in GUI<a href="reg-arima-models.html#impementation-in-gui-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="impementation-in-r-1" class="section level5 hasAnchor" number="18.7.1.3.3">
<h5><span class="header-section-number">18.7.1.3.3</span> Impementation in R<a href="reg-arima-models.html#impementation-in-r-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="java-library-2" class="section level5 hasAnchor" number="18.7.1.3.4">
<h5><span class="header-section-number">18.7.1.3.4</span> Java Library<a href="reg-arima-models.html#java-library-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This test is implemented in the class <code>demetra.stats.tests.BoxPierceTest</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb2-1"><a href="reg-arima-models.html#cb2-1" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> N<span class="op">=</span><span class="dv">100</span><span class="op">;</span></span>
<span id="cb2-2"><a href="reg-arima-models.html#cb2-2" aria-hidden="true" tabindex="-1"></a>    DataBlock sample<span class="op">=</span>DataBlock<span class="op">.</span><span class="fu">make</span><span class="op">(</span>N<span class="op">);</span></span>
<span id="cb2-3"><a href="reg-arima-models.html#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">Random</span> rnd<span class="op">=</span><span class="kw">new</span> <span class="bu">Random</span><span class="op">();</span></span>
<span id="cb2-4"><a href="reg-arima-models.html#cb2-4" aria-hidden="true" tabindex="-1"></a>    sample<span class="op">.</span><span class="fu">set</span><span class="op">(</span>rnd<span class="op">::</span>nextDouble<span class="op">);</span></span>
<span id="cb2-5"><a href="reg-arima-models.html#cb2-5" aria-hidden="true" tabindex="-1"></a>    BoxPierceTest bp<span class="op">=</span><span class="kw">new</span> <span class="fu">BoxPierceTest</span><span class="op">(</span>sample<span class="op">);</span></span>
<span id="cb2-6"><a href="reg-arima-models.html#cb2-6" aria-hidden="true" tabindex="-1"></a>    StatisticalTest test <span class="op">=</span> bp</span>
<span id="cb2-7"><a href="reg-arima-models.html#cb2-7" aria-hidden="true" tabindex="-1"></a>              <span class="op">.</span><span class="fu">lag</span><span class="op">(</span><span class="dv">3</span><span class="op">)</span></span>
<span id="cb2-8"><a href="reg-arima-models.html#cb2-8" aria-hidden="true" tabindex="-1"></a>              <span class="op">.</span><span class="fu">autoCorrelationsCount</span><span class="op">(</span><span class="dv">10</span><span class="op">)</span></span>
<span id="cb2-9"><a href="reg-arima-models.html#cb2-9" aria-hidden="true" tabindex="-1"></a>              <span class="op">.</span><span class="fu">build</span><span class="op">();</span></span></code></pre></div>
</div>
</div>
</div>
<div id="normality" class="section level3 hasAnchor" number="18.7.2">
<h3><span class="header-section-number">18.7.2</span> Normality<a href="reg-arima-models.html#normality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="doornik-hansen-test" class="section level4 hasAnchor" number="18.7.2.1">
<h4><span class="header-section-number">18.7.2.1</span> Doornik-Hansen test<a href="reg-arima-models.html#doornik-hansen-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Doornik-Hansen test for multivariate normality (DOORNIK, J.A., and
HANSEN, H. (2008)) is based on the skewness and kurtosis of multivariate
data that is transformed to ensure independence. It is more powerful
than the Shapiro-Wilk test for most tested multivariate
distributions<a href="#fn107" class="footnote-ref" id="fnref107"><sup>107</sup></a>.</p>
<p>The skewness and kurtosis are defined, respectively, as:
<span class="math display">\[s = \frac{m_{3}}{\sqrt{m_{2}}^{3}}\]</span> and
<span class="math inline">\(k = \frac{m_{4}}{m_{2}^{2}},\ \)</span>where:
<span class="math inline">\(m_{i} = \frac{1}{n}\sum_{i = 1}^{n}{(x_{i}}{- \overline{x})}^{i}\)</span>
<span class="math inline">\(\overline{x} = \frac{1}{n}\sum_{i = 1}^{n}x_{i}\)</span> and <span class="math inline">\(n\)</span> is a number of
(non-missing) residuals.</p>
<p>The Doornik-Hansen test statistic derives from SHENTON, L.R., and
BOWMAN, K.O. (1977) and uses transformed versions of skewness and
kurtosis.</p>
<p>The transformation for the skewness <span class="math inline">\(s\)</span> into<span class="math inline">\(\text{z}_{1}\)</span> is as in
D'AGOSTINO, R.B. (1970):</p>
<p><span class="math display">\[
  \beta = \frac{3(n^{2} + 27n - 70)(n + 1)(n + 3)}{(n - 2)(n + 5)(n + 7)(n + 9)}
  \]</span></p>
<p><span class="math display">\[
  \omega^{2} = - 1 + \sqrt{2(\beta - 1)}
  \]</span></p>
<p><span class="math display">\[
  \delta = \frac{1}{\sqrt{\log{(\omega}^{2})}}
  \]</span></p>
<p><span class="math display">\[
  y = s\sqrt{\frac{(\omega^{2} - 1)(n + 1)(n + 3)}{12(n - 2)}}
  \]</span></p>
<p><span class="math display">\[
  z_{1} = \delta log(y + \sqrt{y^{2} - 1})
  \]</span></p>
<p>The kurtosis <span class="math inline">\(k\)</span> is transformed from a gamma distribution to <span class="math inline">\(\chi^{2}\)</span>,
which is then transformed into standard normal <span class="math inline">\(z_{2}\)</span> using the
Wilson-Hilferty cubed root transformation:</p>
<p><span class="math display">\[
  \delta = (n - 3)(n + 1)(n^{2} + 15n - 4)
  \]</span></p>
<p><span class="math display">\[
  a = \frac{(n - 2)(n + 5)(n + 7)(n^{2} + 27n - 70)}{6\delta}
  \]</span></p>
<p><span class="math display">\[
  c = \frac{(n - 7)(n + 5)(n + 7)(n^{2} + 2n - 5)}{6\delta}
  \]</span></p>
<p><span class="math display">\[
  l= \frac{(n + 5)(n + 7)({n^{3} + 37n}^{2} + 11n - 313)}{12\delta}
  \]</span></p>
<p><span class="math display">\[
  \alpha = a + c \times s^{2}
  \]</span></p>
<p><span class="math display">\[
  \chi = 2l(k - 1 - s^{2})
  \]</span></p>
<p><span class="math display">\[
  z_{2} = \sqrt{9\alpha}\left( \frac{1}{9\alpha} - 1 + \sqrt[3]{\frac{\chi}{2\alpha}} \right)
  \]</span></p>
<p>Finally, the Doornik-Hansen test statistic is defined as the sum of
squared transformations of the skewness and kurtosis. Approximately, the
test statistic follows a <span class="math inline">\(\chi^{2}\)</span>distribution, i.e.:</p>
<p><span class="math display">\[
  DH = z_{1}^{2} + z_{2}^{2}\sim\chi^{2}(2)
  \]</span></p>
</div>
<div id="dagostino" class="section level4 hasAnchor" number="18.7.2.2">
<h4><span class="header-section-number">18.7.2.2</span> D’agostino ?<a href="reg-arima-models.html#dagostino" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="jarque-bera" class="section level4 hasAnchor" number="18.7.2.3">
<h4><span class="header-section-number">18.7.2.3</span> Jarque-Bera<a href="reg-arima-models.html#jarque-bera" class="anchor-section" aria-label="Anchor link to header"></a></h4>

</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="78">
<li id="fn78"><p>DAGUM, E.B. (1980).<a href="reg-arima-models.html#fnref78" class="footnote-back">↩︎</a></p></li>
<li id="fn79"><p>GÓMEZ, V., and MARAVALL, A. (2001b).<a href="reg-arima-models.html#fnref79" class="footnote-back">↩︎</a></p></li>
<li id="fn80"><p>The notation used by TRAMO for the polynomials is different from the one commonly used in the literature, for example in HAMILTON, J.D. (1994) the AR polynomial is denoted as .<a href="reg-arima-models.html#fnref80" class="footnote-back">↩︎</a></p></li>
<li id="fn81"><p>BOX G.E.P., JENKINS, G.M., and REINSEL, G.C. (2007).<a href="reg-arima-models.html#fnref81" class="footnote-back">↩︎</a></p></li>
<li id="fn82"><p>KAISER, R., and MARAVALL, A. (1999).<a href="reg-arima-models.html#fnref82" class="footnote-back">↩︎</a></p></li>
<li id="fn83"><p>‘X-13ARIMA-SEATS Reference Manual’ (2015).<a href="reg-arima-models.html#fnref83" class="footnote-back">↩︎</a></p></li>
<li id="fn84"><p>In the TRAMO-SEATS method this type of outlier is called a transitory change.<a href="reg-arima-models.html#fnref84" class="footnote-back">↩︎</a></p></li>
<li id="fn85"><p>GÓMEZ, V., and MARAVALL, A. (1997).<a href="reg-arima-models.html#fnref85" class="footnote-back">↩︎</a></p></li>
<li id="fn86"><p>Dummy variable is the variable that takes the values 0 or 1 to indicate the absence or presence of some effect.<a href="reg-arima-models.html#fnref86" class="footnote-back">↩︎</a></p></li>
<li id="fn87"><p>GÓMEZ, V., and MARAVALL, A. (2010).<a href="reg-arima-models.html#fnref87" class="footnote-back">↩︎</a></p></li>
<li id="fn88"><p>Parsimonious models are those which have a great deal of explanatory power using a relatively small number of parameters. Balanced models are models for which the order of the combined AR and differencing operators is equal to the order of the combined MA operator (see GÓMEZ, V., and MARAVALL, A. (1997)). A model is said to be more balanced than a competing model if the absolute difference between the total orders of the AR plus differencing and MA operators is smaller for one model than another. For description of the Hannan-Rissanen algorithm see he respective section above, a well as HANNAN, E.J., and RISSANEN, J. (1982), GÓMEZ, V., and MARAVALL, A. (2001b).<a href="reg-arima-models.html#fnref88" class="footnote-back">↩︎</a></p></li>
<li id="fn89"><p>GÓMEZ, V., and MARAVALL, A. (2001b).<a href="reg-arima-models.html#fnref89" class="footnote-back">↩︎</a></p></li>
<li id="fn90"><p>MARAVALL, A. (2000).<a href="reg-arima-models.html#fnref90" class="footnote-back">↩︎</a></p></li>
<li id="fn91"><p>‘X-13ARIMA-SEATS Reference Manual’ (2015).<a href="reg-arima-models.html#fnref91" class="footnote-back">↩︎</a></p></li>
<li id="fn92"><p>DAGUM, E.B. (1988).<a href="reg-arima-models.html#fnref92" class="footnote-back">↩︎</a></p></li>
<li id="fn93"><p>‘X-13ARIMA-SEATS Reference Manual’ (2015).<a href="reg-arima-models.html#fnref93" class="footnote-back">↩︎</a></p></li>
<li id="fn94"><p>The pre-tested options are: one, eight, and fifteen days before Easter.<a href="reg-arima-models.html#fnref94" class="footnote-back">↩︎</a></p></li>
<li id="fn95"><p>CHATFIELD, C. (2004).<a href="reg-arima-models.html#fnref95" class="footnote-back">↩︎</a></p></li>
<li id="fn96"><p>AKAIKE, H. (1973).<a href="reg-arima-models.html#fnref96" class="footnote-back">↩︎</a></p></li>
<li id="fn97"><p>HURVICH, C.M., and TSAI, C. (1989).<a href="reg-arima-models.html#fnref97" class="footnote-back">↩︎</a></p></li>
<li id="fn98"><p>HANNAN, E.J., and QUINN, B.G. (1979).<a href="reg-arima-models.html#fnref98" class="footnote-back">↩︎</a></p></li>
<li id="fn99"><p>SCHWARZ, G. (1978).<a href="reg-arima-models.html#fnref99" class="footnote-back">↩︎</a></p></li>
<li id="fn100"><p>PEÑA, D. (2001).<a href="reg-arima-models.html#fnref100" class="footnote-back">↩︎</a></p></li>
<li id="fn101"><p>HANNAN, E.J., and RISSANEN, J. (1982), NEWBOLD, D., and BOS, T. (1982).<a href="reg-arima-models.html#fnref101" class="footnote-back">↩︎</a></p></li>
<li id="fn102"><p>‘X-13ARIMA-SEATS Reference Manual’ (2015).<a href="reg-arima-models.html#fnref102" class="footnote-back">↩︎</a></p></li>
<li id="fn103"><p>‘X-13ARIMA-SEATS Reference Manual’ (2015).<a href="reg-arima-models.html#fnref103" class="footnote-back">↩︎</a></p></li>
<li id="fn104"><p>MAKRIDAKIS, S., WHEELWRIGHT, S.C., and HYNDMAN, R.J. (1998).<a href="reg-arima-models.html#fnref104" class="footnote-back">↩︎</a></p></li>
<li id="fn105"><p>CHATFIELD, C. (2004).<a href="reg-arima-models.html#fnref105" class="footnote-back">↩︎</a></p></li>
<li id="fn106"><p>CHATFIELD, C. (2004).<a href="reg-arima-models.html#fnref106" class="footnote-back">↩︎</a></p></li>
<li id="fn107"><p>The description of the test derives from DOORNIK, J.A., and
HANSEN, H. (2008).<a href="reg-arima-models.html#fnref107" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spectral-analysis-principles-and-tools.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="moving-average-based-decomposition.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/18-Meth-Reg-Arima-Modelling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
