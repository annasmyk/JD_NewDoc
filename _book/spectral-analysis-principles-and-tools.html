<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Spectral Analysis Principles and Tools | JDemetra+ online documentation</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Spectral Analysis Principles and Tools | JDemetra+ online documentation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Spectral Analysis Principles and Tools | JDemetra+ online documentation" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Anna Smyk" />


<meta name="date" content="2022-05-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tool-selection-issues.html"/>
<link rel="next" href="reg-arima-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">JDemetra+ online documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="jdemetra-software.html"><a href="jdemetra-software.html"><i class="fa fa-check"></i><b>1</b> JDemetra+ Software</a>
<ul>
<li class="chapter" data-level="1.1" data-path="jdemetra-software.html"><a href="jdemetra-software.html#structure-of-this-book"><i class="fa fa-check"></i><b>1.1</b> Structure of this book</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="jdemetra-software.html"><a href="jdemetra-software.html#available-algorithms"><i class="fa fa-check"></i><b>1.1.1</b> Available algorithms</a></li>
<li class="chapter" data-level="1.1.2" data-path="jdemetra-software.html"><a href="jdemetra-software.html#tools-to-access-the-functions"><i class="fa fa-check"></i><b>1.1.2</b> Tools to access the functions</a></li>
<li class="chapter" data-level="1.1.3" data-path="jdemetra-software.html"><a href="jdemetra-software.html#underlying-statistical-methods"><i class="fa fa-check"></i><b>1.1.3</b> Underlying Statistical Methods</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="jdemetra-software.html"><a href="jdemetra-software.html#audience"><i class="fa fa-check"></i><b>1.2</b> Audience</a></li>
<li class="chapter" data-level="1.3" data-path="jdemetra-software.html"><a href="jdemetra-software.html#how-jdemetra-came-to-be"><i class="fa fa-check"></i><b>1.3</b> How Jdemetra+ came to be</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quick-start-with.html"><a href="quick-start-with.html"><i class="fa fa-check"></i><b>2</b> Quick start with…</a>
<ul>
<li class="chapter" data-level="2.1" data-path="quick-start-with.html"><a href="quick-start-with.html#seasonal-adjustment"><i class="fa fa-check"></i><b>2.1</b> Seasonal Adjustment</a></li>
<li class="chapter" data-level="2.2" data-path="quick-start-with.html"><a href="quick-start-with.html#seasonal-adjustment-of-high-frequency-data"><i class="fa fa-check"></i><b>2.2</b> Seasonal Adjustment of High-Frequency Data</a></li>
<li class="chapter" data-level="2.3" data-path="quick-start-with.html"><a href="quick-start-with.html#use-of-jd-algorithms-in-r"><i class="fa fa-check"></i><b>2.3</b> Use of JD+ algorithms in R</a></li>
<li class="chapter" data-level="2.4" data-path="quick-start-with.html"><a href="quick-start-with.html#use-of-jd-graphical-interface"><i class="fa fa-check"></i><b>2.4</b> Use of JD+ graphical interface</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="main-functions-overview.html"><a href="main-functions-overview.html"><i class="fa fa-check"></i><b>3</b> Main functions overview</a>
<ul>
<li class="chapter" data-level="3.1" data-path="main-functions-overview.html"><a href="main-functions-overview.html#seasonal-adjustment-algorithms"><i class="fa fa-check"></i><b>3.1</b> Seasonal adjustment algorithms</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="main-functions-overview.html"><a href="main-functions-overview.html#data-frequencies"><i class="fa fa-check"></i><b>3.1.1</b> Data frequencies</a></li>
<li class="chapter" data-level="3.1.2" data-path="main-functions-overview.html"><a href="main-functions-overview.html#x-13"><i class="fa fa-check"></i><b>3.1.2</b> X-13</a></li>
<li class="chapter" data-level="3.1.3" data-path="main-functions-overview.html"><a href="main-functions-overview.html#stl"><i class="fa fa-check"></i><b>3.1.3</b> STL</a></li>
<li class="chapter" data-level="3.1.4" data-path="main-functions-overview.html"><a href="main-functions-overview.html#tramo-seats"><i class="fa fa-check"></i><b>3.1.4</b> Tramo-Seats</a></li>
<li class="chapter" data-level="3.1.5" data-path="main-functions-overview.html"><a href="main-functions-overview.html#basic-strcutural-models"><i class="fa fa-check"></i><b>3.1.5</b> Basic Strcutural models</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="main-functions-overview.html"><a href="main-functions-overview.html#trend-cycle-estimation"><i class="fa fa-check"></i><b>3.2</b> Trend-cycle estimation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html"><i class="fa fa-check"></i><b>4</b> Seasonal Adjustment</a>
<ul>
<li class="chapter" data-level="4.1" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#motivation"><i class="fa fa-check"></i><b>4.1</b> Motivation</a></li>
<li class="chapter" data-level="4.2" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#unobserved-components-uc"><i class="fa fa-check"></i><b>4.2</b> Unobserved Components (UC)</a></li>
<li class="chapter" data-level="4.3" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#seasonality-tests"><i class="fa fa-check"></i><b>4.3</b> Seasonality tests</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#overview"><i class="fa fa-check"></i><b>4.3.1</b> Overview</a></li>
<li class="chapter" data-level="4.3.2" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#f-test-on-seasonal-dummies"><i class="fa fa-check"></i><b>4.3.2</b> F-test on seasonal dummies</a></li>
<li class="chapter" data-level="4.3.3" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#qs-test-on-autocorrelation-at-seasonal-lags"><i class="fa fa-check"></i><b>4.3.3</b> QS Test on autocorrelation at seasonal lags</a></li>
<li class="chapter" data-level="4.3.4" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#qs-test-for-seasonality-bis-solve-this"><i class="fa fa-check"></i><b>4.3.4</b> QS Test for seasonality (BIS : solve this)</a></li>
<li class="chapter" data-level="4.3.5" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#kurskall-wallis"><i class="fa fa-check"></i><b>4.3.5</b> Kurskall-Wallis</a></li>
<li class="chapter" data-level="4.3.6" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#friedman-test-stable-seasonality-test"><i class="fa fa-check"></i><b>4.3.6</b> Friedman test (stable seasonality test)</a></li>
<li class="chapter" data-level="4.3.7" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#stable-seasonality-test-missing"><i class="fa fa-check"></i><b>4.3.7</b> Stable seasonality test (missing)</a></li>
<li class="chapter" data-level="4.3.8" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#moving-seasonality-test"><i class="fa fa-check"></i><b>4.3.8</b> Moving seasonality test</a></li>
<li class="chapter" data-level="4.3.9" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#identifiable-seasonality"><i class="fa fa-check"></i><b>4.3.9</b> Identifiable seasonality</a></li>
<li class="chapter" data-level="4.3.10" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#combined-seasonality-test"><i class="fa fa-check"></i><b>4.3.10</b> Combined seasonality test</a></li>
<li class="chapter" data-level="4.3.11" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#spectral-analysis"><i class="fa fa-check"></i><b>4.3.11</b> Spectral analysis</a></li>
<li class="chapter" data-level="4.3.12" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#example-of-non-seasonal-series"><i class="fa fa-check"></i><b>4.3.12</b> Example of non seasonal series</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#calendar-correction"><i class="fa fa-check"></i><b>4.4</b> Calendar correction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#tests-for-residual-trading-days"><i class="fa fa-check"></i><b>4.4.1</b> Tests for residual trading days</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#outliers-and-intervention-variables"><i class="fa fa-check"></i><b>4.5</b> Outliers and intervention variables</a></li>
<li class="chapter" data-level="4.6" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#pre-adjustment"><i class="fa fa-check"></i><b>4.6</b> Pre-adjustment</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#overview-1"><i class="fa fa-check"></i><b>4.6.1</b> Overview</a></li>
<li class="chapter" data-level="4.6.2" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#transformation-choices"><i class="fa fa-check"></i><b>4.6.2</b> Transformation choices</a></li>
<li class="chapter" data-level="4.6.3" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#reg-arima-linarization"><i class="fa fa-check"></i><b>4.6.3</b> Reg-Arima linarization</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#decomposition"><i class="fa fa-check"></i><b>4.7</b> Decomposition</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#x-11-moving-average-based-decomposition"><i class="fa fa-check"></i><b>4.7.1</b> X-11 moving average based decomposition</a></li>
<li class="chapter" data-level="4.7.2" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#model-based-decomposition"><i class="fa fa-check"></i><b>4.7.2</b> Model based decomposition</a></li>
<li class="chapter" data-level="4.7.3" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#quality-assesment-of-the-seasonal-adjustement-process"><i class="fa fa-check"></i><b>4.7.3</b> Quality assesment of the seasonal adjustement process</a></li>
<li class="chapter" data-level="4.7.4" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#non-significant-irregular-1"><i class="fa fa-check"></i><b>4.7.4</b> Non significant irregular</a></li>
<li class="chapter" data-level="4.7.5" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#qs-test"><i class="fa fa-check"></i><b>4.7.5</b> QS test</a></li>
<li class="chapter" data-level="4.7.6" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#f-test-1"><i class="fa fa-check"></i><b>4.7.6</b> F test</a></li>
<li class="chapter" data-level="4.7.7" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#sliding-spans"><i class="fa fa-check"></i><b>4.7.7</b> Sliding spans</a></li>
<li class="chapter" data-level="4.7.8" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#revision-policies"><i class="fa fa-check"></i><b>4.7.8</b> Revision policies</a></li>
<li class="chapter" data-level="4.7.9" data-path="seasonal-adjustment-1.html"><a href="seasonal-adjustment-1.html#practical-steps"><i class="fa fa-check"></i><b>4.7.9</b> Practical steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html"><i class="fa fa-check"></i><b>5</b> High Frequency data (seasonal adjustment)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#motivation-1"><i class="fa fa-check"></i><b>5.1</b> Motivation</a></li>
<li class="chapter" data-level="5.2" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#unobserved-components"><i class="fa fa-check"></i><b>5.2</b> Unobserved Components</a></li>
<li class="chapter" data-level="5.3" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#seasonality-tests-1"><i class="fa fa-check"></i><b>5.3</b> Seasonality tests</a></li>
<li class="chapter" data-level="5.4" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#calendar-correction-1"><i class="fa fa-check"></i><b>5.4</b> Calendar correction</a></li>
<li class="chapter" data-level="5.5" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#outliers-and-intervention-variables-1"><i class="fa fa-check"></i><b>5.5</b> Outliers and intervention variables</a></li>
<li class="chapter" data-level="5.6" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#pre-adjustment-1"><i class="fa fa-check"></i><b>5.6</b> Pre-adjustment</a></li>
<li class="chapter" data-level="5.7" data-path="high-frequency-data-seasonal-adjustment.html"><a href="high-frequency-data-seasonal-adjustment.html#decomposition-1"><i class="fa fa-check"></i><b>5.7</b> Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html"><i class="fa fa-check"></i><b>6</b> Generating Calendar regressors and other input variables</a>
<ul>
<li class="chapter" data-level="6.1" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html#motivation-2"><i class="fa fa-check"></i><b>6.1</b> Motivation</a></li>
<li class="chapter" data-level="6.2" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html#underlying-theory"><i class="fa fa-check"></i><b>6.2</b> Underlying theory</a></li>
<li class="chapter" data-level="6.3" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html#available-tools"><i class="fa fa-check"></i><b>6.3</b> Available Tools</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html#gui"><i class="fa fa-check"></i><b>6.3.1</b> GUI</a></li>
<li class="chapter" data-level="6.3.2" data-path="generating-calendar-regressors-and-other-input-variables.html"><a href="generating-calendar-regressors-and-other-input-variables.html#rjd3modelling-package"><i class="fa fa-check"></i><b>6.3.2</b> Rjd3modelling package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="outlier-detection.html"><a href="outlier-detection.html"><i class="fa fa-check"></i><b>7</b> Outlier detection</a>
<ul>
<li class="chapter" data-level="7.1" data-path="outlier-detection.html"><a href="outlier-detection.html#motivation-3"><i class="fa fa-check"></i><b>7.1</b> Motivation</a></li>
<li class="chapter" data-level="7.2" data-path="outlier-detection.html"><a href="outlier-detection.html#with-reg-arima-models"><i class="fa fa-check"></i><b>7.2</b> With Reg Arima models</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="outlier-detection.html"><a href="outlier-detection.html#part-of-preadjustment"><i class="fa fa-check"></i><b>7.2.1</b> Part of preadjustment</a></li>
<li class="chapter" data-level="7.2.2" data-path="outlier-detection.html"><a href="outlier-detection.html#specific-terror-tool"><i class="fa fa-check"></i><b>7.2.2</b> specific TERROR tool</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="outlier-detection.html"><a href="outlier-detection.html#with-structural-models"><i class="fa fa-check"></i><b>7.3</b> With structural models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modelling-time-series.html"><a href="modelling-time-series.html"><i class="fa fa-check"></i><b>8</b> Modelling Time Series</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modelling-time-series.html"><a href="modelling-time-series.html#motivation-4"><i class="fa fa-check"></i><b>8.1</b> Motivation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="benchmarking-and-temporal-disagreggation.html"><a href="benchmarking-and-temporal-disagreggation.html"><i class="fa fa-check"></i><b>9</b> Benchmarking and temporal disagreggation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="benchmarking-and-temporal-disagreggation.html"><a href="benchmarking-and-temporal-disagreggation.html#benchmarking-overview"><i class="fa fa-check"></i><b>9.1</b> Benchmarking overview</a></li>
<li class="chapter" data-level="9.2" data-path="benchmarking-and-temporal-disagreggation.html"><a href="benchmarking-and-temporal-disagreggation.html#underlying-theory-1"><i class="fa fa-check"></i><b>9.2</b> Underlying Theory</a></li>
<li class="chapter" data-level="9.3" data-path="benchmarking-and-temporal-disagreggation.html"><a href="benchmarking-and-temporal-disagreggation.html#tools"><i class="fa fa-check"></i><b>9.3</b> Tools</a></li>
<li class="chapter" data-level="9.4" data-path="benchmarking-and-temporal-disagreggation.html"><a href="benchmarking-and-temporal-disagreggation.html#references-4"><i class="fa fa-check"></i><b>9.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="trend-cycle-estimation-1.html"><a href="trend-cycle-estimation-1.html"><i class="fa fa-check"></i><b>10</b> Trend-cycle estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="trend-cycle-estimation-1.html"><a href="trend-cycle-estimation-1.html#motivation-5"><i class="fa fa-check"></i><b>10.1</b> Motivation</a></li>
<li class="chapter" data-level="10.2" data-path="trend-cycle-estimation-1.html"><a href="trend-cycle-estimation-1.html#underlying-theory-2"><i class="fa fa-check"></i><b>10.2</b> Underlying Theory</a></li>
<li class="chapter" data-level="10.3" data-path="trend-cycle-estimation-1.html"><a href="trend-cycle-estimation-1.html#tools-1"><i class="fa fa-check"></i><b>10.3</b> Tools</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="nowcasting.html"><a href="nowcasting.html"><i class="fa fa-check"></i><b>11</b> Nowcasting</a></li>
<li class="chapter" data-level="12" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html"><i class="fa fa-check"></i><b>12</b> Graphical User Interface</a>
<ul>
<li class="chapter" data-level="12.1" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#structure-and-assets"><i class="fa fa-check"></i><b>12.1</b> Structure and assets</a></li>
<li class="chapter" data-level="12.2" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#main-functions"><i class="fa fa-check"></i><b>12.2</b> Main functions</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#seasonality-tests-2"><i class="fa fa-check"></i><b>12.2.1</b> Seasonality tests</a></li>
<li class="chapter" data-level="12.2.2" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#seasonal-adjustment-2"><i class="fa fa-check"></i><b>12.2.2</b> Seasonal adjustment</a></li>
<li class="chapter" data-level="12.2.3" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#theoretical-spectrum-of-the-arima-model"><i class="fa fa-check"></i><b>12.2.3</b> Theoretical spectrum of the Arima model</a></li>
<li class="chapter" data-level="12.2.4" data-path="graphical-user-interface.html"><a href="graphical-user-interface.html#benchmarking"><i class="fa fa-check"></i><b>12.2.4</b> Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>13</b> R packages</a>
<ul>
<li class="chapter" data-level="13.1" data-path="r-packages.html"><a href="r-packages.html#available-functions"><i class="fa fa-check"></i><b>13.1</b> Available functions</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="r-packages.html"><a href="r-packages.html#seasonal-adjustment-3"><i class="fa fa-check"></i><b>13.1.1</b> Seasonal Adjustment</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="r-packages.html"><a href="r-packages.html#interaction-with-gui"><i class="fa fa-check"></i><b>13.2</b> Interaction with GUI</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="plug-ins-for-jdemetra.html"><a href="plug-ins-for-jdemetra.html"><i class="fa fa-check"></i><b>14</b> Plug-ins for JDemetra+</a>
<ul>
<li class="chapter" data-level="14.1" data-path="plug-ins-for-jdemetra.html"><a href="plug-ins-for-jdemetra.html#main-functions-1"><i class="fa fa-check"></i><b>14.1</b> Main functions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="production.html"><a href="production.html"><i class="fa fa-check"></i><b>15</b> Production</a></li>
<li class="chapter" data-level="16" data-path="tool-selection-issues.html"><a href="tool-selection-issues.html"><i class="fa fa-check"></i><b>16</b> Tool selection issues</a></li>
<li class="chapter" data-level="17" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html"><i class="fa fa-check"></i><b>17</b> Spectral Analysis Principles and Tools</a>
<ul>
<li class="chapter" data-level="17.1" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#overview-2"><i class="fa fa-check"></i><b>17.1</b> Overview</a></li>
<li class="chapter" data-level="17.2" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#periodogram"><i class="fa fa-check"></i><b>17.2</b> Periodogram</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#step-1"><i class="fa fa-check"></i><b>17.2.1</b> Step 1</a></li>
<li class="chapter" data-level="17.2.2" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#step-2"><i class="fa fa-check"></i><b>17.2.2</b> Step 2</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#autoregressive-spectrum-estimation"><i class="fa fa-check"></i><b>17.3</b> Autoregressive spectrum estimation</a></li>
<li class="chapter" data-level="17.4" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#tukey-spectrum-definition"><i class="fa fa-check"></i><b>17.4</b> Tukey Spectrum definition</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="spectral-analysis-principles-and-tools.html"><a href="spectral-analysis-principles-and-tools.html#theoretical-spectrum-of-the-arima-model-1"><i class="fa fa-check"></i><b>17.4.1</b> Theoretical spectrum of the ARIMA model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="reg-arima-models.html"><a href="reg-arima-models.html"><i class="fa fa-check"></i><b>18</b> Reg-Arima models</a>
<ul>
<li class="chapter" data-level="18.1" data-path="reg-arima-models.html"><a href="reg-arima-models.html#overview-3"><i class="fa fa-check"></i><b>18.1</b> Overview</a></li>
<li class="chapter" data-level="18.2" data-path="reg-arima-models.html"><a href="reg-arima-models.html#regarima-model"><i class="fa fa-check"></i><b>18.2</b> RegARIMA model</a></li>
<li class="chapter" data-level="18.3" data-path="reg-arima-models.html"><a href="reg-arima-models.html#autocorrelation-function"><i class="fa fa-check"></i><b>18.3</b> Autocorrelation function</a></li>
<li class="chapter" data-level="18.4" data-path="reg-arima-models.html"><a href="reg-arima-models.html#estimation-of-arma-models"><i class="fa fa-check"></i><b>18.4</b> Estimation Of Arma models</a></li>
<li class="chapter" data-level="18.5" data-path="reg-arima-models.html"><a href="reg-arima-models.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>18.5</b> Maximum likelihood estimation</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="reg-arima-models.html"><a href="reg-arima-models.html#likelihood-of-a-multivariate-normal-distribution"><i class="fa fa-check"></i><b>18.5.1</b> Likelihood of a multivariate normal distribution</a></li>
<li class="chapter" data-level="18.5.2" data-path="reg-arima-models.html"><a href="reg-arima-models.html#linear-model-with-gaussian-noises"><i class="fa fa-check"></i><b>18.5.2</b> Linear model with gaussian noises</a></li>
<li class="chapter" data-level="18.5.3" data-path="reg-arima-models.html"><a href="reg-arima-models.html#implementation-3"><i class="fa fa-check"></i><b>18.5.3</b> Implementation</a></li>
<li class="chapter" data-level="18.5.4" data-path="reg-arima-models.html"><a href="reg-arima-models.html#missing-values"><i class="fa fa-check"></i><b>18.5.4</b> Missing values</a></li>
<li class="chapter" data-level="18.5.5" data-path="reg-arima-models.html"><a href="reg-arima-models.html#perfect-collinearity-in-x"><i class="fa fa-check"></i><b>18.5.5</b> Perfect collinearity in X</a></li>
<li class="chapter" data-level="18.5.6" data-path="reg-arima-models.html"><a href="reg-arima-models.html#references-6"><i class="fa fa-check"></i><b>18.5.6</b> References</a></li>
<li class="chapter" data-level="18.5.7" data-path="reg-arima-models.html"><a href="reg-arima-models.html#x-13-implementation"><i class="fa fa-check"></i><b>18.5.7</b> X-13 implementation</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="reg-arima-models.html"><a href="reg-arima-models.html#handling-of-missing-observations-in-regarima-models"><i class="fa fa-check"></i><b>18.6</b> Handling of missing observations in (Reg)ARIMA models</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="reg-arima-models.html"><a href="reg-arima-models.html#skipping-approach"><i class="fa fa-check"></i><b>18.6.1</b> Skipping approach</a></li>
<li class="chapter" data-level="18.6.2" data-path="reg-arima-models.html"><a href="reg-arima-models.html#additive-outlier-approach"><i class="fa fa-check"></i><b>18.6.2</b> Additive outlier approach</a></li>
<li class="chapter" data-level="18.6.3" data-path="reg-arima-models.html"><a href="reg-arima-models.html#references-8"><i class="fa fa-check"></i><b>18.6.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="reg-arima-models.html"><a href="reg-arima-models.html#tests-on-residuals"><i class="fa fa-check"></i><b>18.7</b> Tests on residuals</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="reg-arima-models.html"><a href="reg-arima-models.html#autocorrelation"><i class="fa fa-check"></i><b>18.7.1</b> Autocorrelation</a></li>
<li class="chapter" data-level="18.7.2" data-path="reg-arima-models.html"><a href="reg-arima-models.html#normality"><i class="fa fa-check"></i><b>18.7.2</b> Normality</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="moving-average-based-decomposition.html"><a href="moving-average-based-decomposition.html"><i class="fa fa-check"></i><b>19</b> Moving average based decomposition</a></li>
<li class="chapter" data-level="20" data-path="arima-model-based-decomposition.html"><a href="arima-model-based-decomposition.html"><i class="fa fa-check"></i><b>20</b> Arima Model based decomposition</a></li>
<li class="chapter" data-level="21" data-path="state-space-framework.html"><a href="state-space-framework.html"><i class="fa fa-check"></i><b>21</b> State Space Framework</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">JDemetra+ online documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spectral-analysis-principles-and-tools" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">Chapter 17</span> Spectral Analysis Principles and Tools<a href="spectral-analysis-principles-and-tools.html#spectral-analysis-principles-and-tools" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>add : R code, rjd3toolkit references</p>
<div id="overview-2" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">17.1</span> Overview<a href="spectral-analysis-principles-and-tools.html#overview-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="periodogram" class="section level2 hasAnchor" number="17.2">
<h2><span class="header-section-number">17.2</span> Periodogram<a href="spectral-analysis-principles-and-tools.html#periodogram" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="step-1" class="section level3 hasAnchor" number="17.2.1">
<h3><span class="header-section-number">17.2.1</span> Step 1<a href="spectral-analysis-principles-and-tools.html#step-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For any given frequency <span class="math inline">\(\omega\)</span> the sample periodogram is the sample
analog of the sample spectrum. In general, the periodogram is used to
identify the periodic components of unknown frequency in the time
series. X-13ARIMA-SEATS and TRAMO-SEATS use this tool for detecting
seasonality in raw time series and seasonally adjusted series. Apart
from this it is applied for checking randomness of the residuals from
the ARIMA model.</p>
<p>To define the periodogram, first consider the vector of complex
numbers<a href="#fn61" class="footnote-ref" id="fnref61"><sup>61</sup></a>:</p>
<p><span class="math display">\[\mathbf{x} = \begin{bmatrix}      
  x_{1} \\                             
  x_{2} \\                             
  . \\                                 
  . \\                                 
  . \\                                 
  x_{n} \\                             
  \end{bmatrix} \in \mathbb{C}^{n}\]</span></p>
<p>where <span class="math inline">\(\mathbb{C}^{n}\)</span> is the set of all column vectors with
complex-valued components.</p>
<p>The Fourier frequencies associated with the sample size <span class="math display">\[n\]</span> are
defined as a set of values <span class="math display">\[ω_{j} = \frac{2\pi j}{n}\]</span>,
<span class="math display">\[j = - \lbrack \frac{n-1}{2}\rbrack,\ldots,\lbrack\frac{n}{2}\rbrack\]</span>,
<span class="math display">\[-\pi&lt; \omega_{j} \leq \pi\]</span>, <span class="math display">\[j\in F_{n}\]</span>, where <span class="math inline">\({\lbrack n\rbrack}\)</span> denotes the largest integer less than or
equal to <span class="math inline">\(n\)</span>. The Fourier frequencies, which are called harmonics, are
given by integer multiples of the fundamental frequency
<span class="math inline">\(\ \frac{2\pi}{n}\)</span>.</p>
<p>Now the <span class="math inline">\(n\)</span> vectors
<span class="math display">\[e_{j} = n^{- \frac{1}{2}}\left(e^{-i\omega_{j}},e^{-i{2\omega}_{j}},
\ldots,e^{- inω_{j}}\right)^{&#39;}\]</span> can be defined. Vectors <span class="math display">\[e_{1},\ldots, e_{n}\]</span> are orthonormal in the
sense that:</p>
<p><span class="math display">\[
{\mathbf{e}_{j}^{*}\mathbf{e}}_{k} = n^{- 1}\sum_{r = 1}^{n}e^{ir(\omega_{j} - \omega_{k})} = \left\{ \begin{matrix}  
  1,\ if\ j = k \\                                                                                                         
  0,\ if\ j \neq k \\                                                                                                      
  \end{matrix} \right.\
  \]</span></p>
<p>where <span class="math display">\[\mathbf{e}_{j}^{*}\]</span> denotes the row vector, which <span class="math display">\[k^{th}\]</span>
component is the complex conjugate of the <span class="math display">\[k^{th}\]</span> component of
<span class="math display">\[\mathbf{e}_{j}\]</span>.<a href="#fn62" class="footnote-ref" id="fnref62"><sup>62</sup></a> These vectors are a basis of <span class="math display">\[F_{n}\]</span>, so that any
<span class="math display">\[\mathbf{x}\in\mathbb{C}^{n}\]</span> can be expressed as a sum of <span class="math display">\[n\]</span> components:</p>
<p><span class="math display">\[
\mathbf{x} = \sum_{j = - \lbrack\frac{n - 1}{2}\rbrack}^{\lbrack\frac{n}{2}\rbrack}{a_{j}\mathbf{e}_{j}}
\]</span></p>
<p>where the coefficients
<span class="math display">\[a_{j} = \mathbf{e}_{j}^{*}\mathbf{x}=n^{-\frac{1}{2}}\sum_{t = 1}^{n}x_{t}e^{-it\omega_{j}}\]</span> are derived from <span class="math display">\[3\]</span> by multiplying the equation on the left by <span class="math display">\[\mathbf{e}_{j}^{*}\]</span> and using <span class="math display">\[1\]</span>.</p>
<p>The sequence of <span class="math display">\[\{a_{j},j\in F_{n}\}\]</span> is referred as a
discrete Fourier transform of <span class="math inline">\(\mathbf{x}\mathbb{\in C}^{n}\)</span> and the
periodogram <span class="math inline">\(I(\omega_{j})\)</span> of <span class="math inline">\(\mathbf{x}\)</span> at Fourier frequency
<span class="math inline">\(\omega_{j} = \frac{2\pi j}{n}\)</span> is defined as the square of the Fourier
transform <span class="math display">\[\{a_{j}\}\]</span> of <span class="math inline">\(\mathbf{x}\)</span>:</p>
<p><span class="math display">\[
{I\left( \omega_{j} \right)\mathbf{=}{\left| a_{j} \right|^{2}}_{\ } = n^{- \ 1}\left| \sum_{t = 1}^{n}x_{t}e^{- it\omega_{j}} \right|^{2}}_{\mathbf{\ }}
\]</span></p>
<p>From <span class="math display">\[2\]</span> and <span class="math display">\[3\]</span> it can be shown that in fact the
periodogram decomposes the total sum of squares
<span class="math inline">\(\sum_{t = 1}^{n}\left| x_{t} \right|^{2}\)</span> into a sums of components
associated with the Fourier frequencies <span class="math display">\[ω_{j}\]</span>:</p>
<p><span class="math display">\[
  \sum_{t=1}^{n}{\left|x_{t}\right|}^{2} = \sum_{j = - \lbrack\frac{n - 1}{2}\rbrack}^{\lbrack\frac{n}{2}\rbrack}\left|a_{j}\right|^{2} = \sum_{j = - \lbrack\frac{n - 1}{2}\rbrack}^{\lbrack\frac{n}{2}\rbrack}{I\left( \omega_{j} \right)}
\]</span></p>
<p>If <span class="math inline">\(\ \mathbf{x\  \in}\ {R}^{n}\)</span>, <span class="math inline">\(\omega_{j}\)</span> and
<span class="math display">\[{-\omega}_{j}\]</span> are both in
<span class="math display">\[\lbrack- \pi, -\pi \rbrack\]</span> and <span class="math display">\[a_{j}\]</span> is presented in its polar form
(i.e.<span class="math display">\[a_{j} = r_{j}\exp\left( i\theta_{j} \right)\]</span>), where
<span class="math inline">\(r_{j}\)</span> is the modulus of <span class="math display">\[a_{j}\]</span>, then <span class="math display">\[3\]</span> can be
rewritten in the form:</p>
<p><span class="math display">\[
\mathbf{x} = a_{0}\mathbf{e}_{0} + \sum_{j = 1}^{\lbrack\frac{n - 1}{2}\rbrack}{ {2^{1/2}r}_{j}{(\mathbf{c}}_{j}\cos\theta_{j}{- \mathbf{s}}_{j}\sin\theta_{j}) + a_{n/2}\mathbf{e}_{n/2}}
\]</span></p>
<p>The orthonormal basis for <span class="math display">\[{R}^{n}\]</span> is
<span class="math display">\[\{\mathbf{e}_{0},\mathbf{c}_{1},\mathbf{s}_{1},\ldots,\mathbf{c}_{\lbrack\frac{n - 1}{2}\rbrack},\mathbf{s}_{\lbrack\frac{n - 1}{2}\rbrack},\mathbf{e}_{\frac{n}{2}(excluded\ if\ n\ is\ odd)}\}
\]</span>,
where:</p>
<p><span class="math display">\[\mathbf{e}_{0}\]</span> is a vector composed of n elements equal to <span class="math display">\[n^{- 1/2}\]</span>, which implies that <span class="math display">\[\mathbf{a}_{0}\mathbf{e}_{0} = {(n^{-1}\sum_{t = 1}^{n}x_{t},\ldots,n^{- 1}\sum_{t=1}^{n}x_{t})}^{&#39;}\]</span>;</p>
<p><span class="math display">\[
\mathbf{c}_{j}=\left(\frac{n}{2}\right)^{- 1/2}{\left(\cos\omega_{j},\cos{2\omega}_{j},\ldots,\cos{n\omega_{j}}\right)}^{&#39;}, for 1 \leq j \leq \lbrack \frac{(n - 1)}{2}\rbrack
\]</span> ;</p>
<p><span class="math display">\[
\mathbf{s}_{j} = {\left( \frac{n}{2} \right)}^{-1/2}{\left(\sin{\omega_{j}},\sin{2\omega_{j}},\ldots,\sin{n\omega_{j}}\right)}^{&#39;},\ for\ 1 \leq j \leq \lbrack \frac{(n - 1)}{2} \rbrack
\]</span>;</p>
<p><span class="math display">\[
\mathbf{e}_{n/2} = {\left(- \left(n^{-\frac{1}{2}}\right),n^{- \frac{1}{2}},\ldots,{-\left(n\right)}^{- \frac{1}{2}}),n^{-\frac{1}{2}}\right)}^{&#39;}
\]</span>.</p>
<p>Equation <span class="math display">\[5\]</span> can be seen as an OLS regression of <span class="math display">\[x_{t}\]</span> on a
constant and the trigonometric terms. As the vector of explanatory
variables includes <span class="math display">\[n\]</span> elements, the number of explanatory
variables in <span class="math display">\[5\]</span> is equal to the number of observations. HAMILTON,
J.D. (1994) shows that the explanatory variables are linearly
independent, which implies that an OLS regression yields a perfect fit
(i.e. without an error term). The coefficients have the form of a simple
OLS projection of the data on the orthonormal basis:</p>
<p><span class="math display">\[
  {\widehat{a}}_{0}=\frac{1}{\sqrt{n}}\sum_{t=1}^{n}x_{t}
  \]</span> <span class="math display">\[7\]</span> <!---\[7.108\]      --></p>
<p><span class="math display">\[
  {\widehat{a}}_{n/2}=\frac{1}{\sqrt{n}}\sum_{t=1}^{n}{(-1)}^{t}x_{t}\left(   \text{only when n is even} \right)
  \]</span> <span class="math display">\[8\]</span> <!---\[7.109\]      --></p>
<p><span class="math display">\[
  {\widehat{a}}_{0}=\frac{1}{\sqrt{n}}\sum_{t=1}^{n}x_{t}
  \]</span> <span class="math display">\[9\]</span> <!---\[7.110\]      --></p>
<p><span class="math display">\[
  {\widehat{\alpha}}_{j} = 2^{1/2}r_{j}\cos{\theta_{j}} = {\left(\frac{n}{2} \right)}^{- 1/2}\sum_{t = 1}^{n}x_{t}\cos{\left(t\frac{2\pi j}{n}\right)}, j   = 1,\ldots,\lbrack\frac{n - 1}{2}\rbrack
  \]</span> <span class="math display">\[10\]</span> <!---\[7.111\]      --></p>
<p><span class="math display">\[
  {\widehat{\beta}}_{j} = 2^{1/2}r_{j}\sin{\theta_{j}} = {\left( \frac{n}{2} \right)}^{-1/2}\sum_{t = 1}^{n}x_{t}\sin{\left(t\frac{2\pi j}{n} \right)}, j = 1,\ldots,\lbrack\frac{n - 1}{2}\rbrack
  \]</span> <span class="math display">\[11\]</span> <!---\[7.112\]      --></p>
<p>With <span class="math display">\[5\]</span> the total sum of squares
<span class="math inline">\(\sum_{t = 1}^{n}\left| x_{t} \right|^{2}\)</span> can be decomposed into
<span class="math display">\[2 \times \lbrack\frac{n - 1}{2}\rbrack\]</span> components corresponding to
<span class="math display">\[\mathbf{c}_{j}\]</span> and <span class="math display">\[\mathbf{s}_{j}\]</span>, which are grouped to produce
the “frequency <span class="math display">\[ω_{j}\]</span>” component for <span class="math display">\[1 \geq j \geq \lbrack\frac{n - 1}{2}\rbrack\]</span>. As it is shown in the table below, the
value of the periodogram at the frequency <span class="math inline">\(\omega_{j}\)</span> is the
contribution of the<span class="math inline">\(\ j^{\text{th}}\ \)</span>harmonic to the total sum of
squares <span class="math inline">\(\sum_{t = 1}^{n}\left| x_{t} \right|^{2}\)</span>.</p>
<p><strong>Decomposition of sum of squares into components
corresponding to the harmonics</strong></p>
<p>{: .table .table-style}
|<strong>Frequency</strong> |<strong>Degrees of freedom</strong> |<strong>Sum of squares decomposition</strong>|
|———————————————– |———————— |————————————————————-|
|<span class="math inline">\(\omega_{0}\)</span>(mean) |1 |<span class="math display">\[{a_{0}^{2}}_{\ }=n^{- 1}\left( \sum_{t=1}^{n}x_{t} \right)^{2} = I\left( 0 \right)\]</span>|
|<span class="math display">\[\omega_{1}\]</span> |2 |<span class="math display">\[{2r_{1}^{2}}_{\ } = 2{\|a_{1}\|}^{2} = 2I\left( \omega_{1} \right)\]</span>|
|<span class="math display">\[\vdots\]</span> |<span class="math display">\[\vdots\]</span> |<span class="math display">\[\vdots\]</span>|
|<span class="math display">\[\omega_{k}\]</span> |2 |<span class="math display">\[{2r_{k}^{2}}_{\ } = 2{\|a_{k}\|}^{2} = 2I\left( \omega_{k} \right)\]</span>|
|<span class="math display">\[\vdots\]</span> |<span class="math display">\[\vdots\]</span> |<span class="math display">\[\vdots\]</span>|
|<span class="math inline">\(\omega_{n/2} = \pi\)</span> (excluded if <span class="math inline">\(n\)</span> is odd) |1 |<span class="math display">\[a_{n/2}^{2} = I\left( \pi \right)\]</span>|
|<strong>Total</strong> |<span class="math display">\[\mathbf{n}\]</span> |<span class="math display">\[\sum_{\mathbf{t = 1}}^{\mathbf{n}}\mathbf{x}_{\mathbf{t}}^{\mathbf{2}}\]</span>|</p>
<p>Source: DE ANTONIO, D., and PALATE, J. (2015).</p>
<p>Obviously, if series were random then each component
<span class="math inline">\(I\left( \omega_{j} \right)\ \)</span>would have the same expectation. On the
contrary, when the series contains a systematic sine component having a
frequency <span class="math inline">\(j\)</span> and amplitude <span class="math inline">\(A\)</span> then the sum of squares
<span class="math inline">\(I\left( \omega_{j} \right)\)</span> increases with <span class="math inline">\(A\)</span>. In practice, it is
unlikely that the frequency <span class="math inline">\(j\)</span> of an unknown systematic sine component
would exacly match any of the frequencies, for which peridogram have
been calcuated. Therefore, the periodogram would show an increase in
intensities in the immediate vicinity of <span class="math inline">\(j\)</span>.<a href="#fn63" class="footnote-ref" id="fnref63"><sup>63</sup></a></p>
<p>Note that in JDemetra+ the periodogram object corresponds exactly to the
contribution to the sum of squares of the standardised data, since the
series are divided by their standard deviation for computational
reasons.</p>
<p>Using the decomposition presented in table above the periodogram can be
expressed as:</p>
<p><span class="math display">\[
I\left( \omega_{j} \right)\mathbf{=}\begin{matrix}                                                                                r_{j}^{2} = \frac{1}{2}{(\alpha}_{j}^{2} + \beta_{j}^{2}) = \ {\frac{1}{n}\left( \sum_{t = 1}^{n}{x_{t}\cos{\left( {t\frac{2\pi j}{n}}_{\ } \right)\ }} \right)}^{2} + \frac{1}{n}\left( \sum_{t = 1}^{n}{x_{t}\sin\left( t\frac{2\pi j}{n} \right)_{\ }} \right)^{2} \\   
\end{matrix}
\]</span> <span class="math display">\[12\]</span> <!---\[7.113\]      --></p>
<p>where <span class="math inline">\(j = 0,\ldots,\left\lbrack \frac{n}{2} \right\rbrack\)</span><em>.</em></p>
<p>Since <span class="math inline">\(\mathbf{x} - \overline{\mathbf{x}}\)</span> are generated by an
orthonormal basis, and
<span class="math inline">\(\overline{\mathbf{x}}\mathbf{=}a_{0}\mathbf{e}_{0}\)</span> <span class="math display">\[5\]</span> can be
rearranged to show that the sum of squares is equal to the sum of the
squared coefficients:</p>
<p><span class="math display">\[
\mathbf{x} - a_{0}\mathbf{e}_{0} =\sum_{j=1}^{\lbrack(n - 1)/2\rbrack}\left(\alpha_{j}\mathbf{c}_{j}+\beta_{j}\mathbf{s}_{j}\right) + a_{n/2}\mathbf{e}_{n/2}
\]</span>. <span class="math display">\[13\]</span> <!---\[7.114\]      --></p>
<p>Thus the sample variance of <span class="math display">\[x_{t}\]</span> can be expressed as:</p>
<p><span class="math display">\[
n^{- 1}\sum_{t=1}^{n}{\left(x_{t}-\overline{x}\right)}^{2}=n^{-1}\left(\sum_{k=1}^{\lbrack(n - 1)/2\rbrack}2{r_{j}}^{2}
+{a_{n/2}}^{2}\right)
\]</span>, <span class="math display">\[14\]</span> <!---\[7.115\]      --></p>
<p>where <span class="math inline">\(a_{n/2}^{2}\)</span> is excluded if <span class="math inline">\(n\)</span> is odd.</p>
<p>The term <span class="math display">\[2{r_{j}}^{2}\]</span> in <span class="math display">\[14\]</span> is then the contribution of
the <span class="math inline">\(j^{\text{th}}\)</span> harmonic to the variance and <span class="math display">\[14\]</span> shows then
how the total variance is partitioned.</p>
<p>The periodogram ordinate <span class="math inline">\(I\left( \omega_{j} \right)\)</span> and the
autocovariance coefficient <span class="math inline">\(\gamma(k)\)</span> are both quadratic forms of
<span class="math display">\[x_{t}\]</span>. It can be shown that the periodogram and
autocovarinace function are related and the periodogram can be written
in terms of the sample autocovariance function for any non-zero Fourier
frequency <span class="math display">\[ω_{j}\]</span> :<a href="#fn64" class="footnote-ref" id="fnref64"><sup>64</sup></a></p>
<p><span class="math display">\[
  I\left( \omega_{j} \right) = \sum_{\left| k \right| &lt; n}^{\ }{\widehat{\gamma}\left( k \right)}_{\ }e^{- ik\omega_{j}} = {\widehat{\gamma}\left( 0 \right)}_{\ } + 2\sum_{k = 1}^{n - 1}{\widehat{\gamma}\left( k \right)\cos{(k\omega_{j})}}_{\ }
  \]</span></p>
<p>and for the zero frequency
<span class="math inline">\(\ I\left( 0 \right) = n\left| \overline{x} \right|^{2}\)</span>.</p>
<p>Once comparing <span class="math display">\[15\]</span> with an expression for the spectral density of
a stationary process:</p>
<p><span class="math display">\[
f\left( \omega_{\ } \right) = \frac{1}{2\pi}\sum_{k &lt; - \infty}^{\infty}{\gamma\left( k \right)}_{\ }e^{- ik\omega_{\ }} = \frac{1}{2\pi}\left\lbrack {\gamma\left( 0 \right)}_{\ } + 2\left(\sum_{k = 1}^{\infty}{\gamma\left( k \right)\cos{(k\omega_{\ })}} \right) \right\rbrack
   \]</span></p>
<p>it can be noticed that the periodogram is a sample analog of the
population spectrum. In fact, it can be shown that the periodogram is
asymptotically unbiased but inconsistent estimator of the population
spectum <span class="math inline">\(f(\omega)\)</span>.[^75] Therefore, the periodogram is a wildly
fluctuatating, with high variance, estimate of the spectrum. However,
the consistent estimator can be achieved by applying the different
linear smoothing filters to the periodogram, called lag-window
estimators. The lag-window estimators implemented in JDemetra+ includes
square, Welch, Tukey, Barlett, Hanning and Parzen. They are described in
DE ANTONIO, D., and PALATE, J. (2015). Alternatively, the model-based
consistent estimation procedure, resulting in autoregressive spectrum
estimator, can be applied.</p>
</div>
<div id="step-2" class="section level3 hasAnchor" number="17.2.2">
<h3><span class="header-section-number">17.2.2</span> Step 2<a href="spectral-analysis-principles-and-tools.html#step-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The periodogram <span class="math display">\[ I(\omega_j)\]</span> of <span class="math display">\[ \mathbf{X} \in \mathbb{C}^n \]</span> is defined as the squared of the Fourier transform</p>
<p><span class="math display">\[
I(\omega_{j})=a_{j}^{2}=n^{-1}\left| \sum_{t=1}^{n}\mathbf{X_t} e^{-it\omega_j} \right|^{2},
\]</span></p>
<p>where the Fourier frequencies <span class="math display">\[ \omega_{j} \]</span> are given by multiples of the fundamental frequency <span class="math display">\[ \frac{2\pi}{n} \]</span>:</p>
<p><span class="math display">\[
\omega_{j}= \frac{2\pi j}{n}, -\pi &lt; \omega_{j} \leq \pi
\]</span></p>
<p>An orthonormal basis in <span class="math display">\[ \mathbb{R}^n \]</span>:</p>
<p><span class="math display">\[
\left\{ e_0, ~~~~~~c_1, s_1, ~~~~~\ldots~~~~~\ , ~~~~c_{[(n-1)/2]}, s_{[(n-1)/2]}~~~~,~~~~~~ e_{n/2}  \right\},
\]</span>
where <span class="math display">\[ e_{n/2} \]</span> is excluded if <span class="math display">\[ n \]</span> is odd,<br />
can be used to project the data and obtain the spectral decomposition</p>
<p>Thus, the periodogram is given by the projection coefficients and represents the contribution of the jth
harmonic to the total sum of squares, as illustrated by Brockwell and Davis (1991):</p>
<table>
<colgroup>
<col width="25%" />
<col width="41%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th align="center">Degrees of freedom</th>
<th align="right"><span class="math display">\[~~~~\]</span> Sum of squares decomposition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frequency <span class="math display">\[ \omega_{0} \]</span></td>
<td align="center">1</td>
<td align="right"><span class="math display">\[ a_{0}^{2}= n^{-1}(\sum_{t=1}^{n}x_t )^2 =I(0)\]</span></td>
</tr>
<tr class="even">
<td>Frequency <span class="math display">\[ \omega_{1} \]</span></td>
<td align="center">2</td>
<td align="right"><span class="math display">\[ 2 r^{2}_{1} = 2 \left\| a_{1} \right\|^{2} = 2 I(\omega_{1}) \]</span></td>
</tr>
<tr class="odd">
<td><span class="math display">\[ \vdots \]</span></td>
<td align="center"><span class="math display">\[ \vdots \]</span></td>
<td align="right"><span class="math display">\[ \vdots \]</span></td>
</tr>
<tr class="even">
<td>Frequency <span class="math display">\[ \omega_{k} \]</span></td>
<td align="center">2</td>
<td align="right"><span class="math display">\[ 2 r^{2}_{k} = 2 \left\| a_{k} \right\|^{2} = 2 I(\omega_{k}) \]</span></td>
</tr>
<tr class="odd">
<td><span class="math display">\[ \vdots \]</span></td>
<td align="center"><span class="math display">\[ \vdots \]</span></td>
<td align="right"><span class="math display">\[ \vdots \]</span></td>
</tr>
<tr class="even">
<td>Frequency <span class="math display">\[ \omega_{n/2}=\pi \]</span></td>
<td align="center">1</td>
<td align="right"><span class="math display">\[ a_{n/2}^{2} = I(\pi) \]</span></td>
</tr>
<tr class="odd">
<td>(excluded if <span class="math display">\[ n \]</span> is odd)</td>
<td align="center"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td><span class="math display">\[ ========= \]</span></td>
<td align="center"><span class="math display">\[ ====== \]</span></td>
<td align="right"><span class="math display">\[ ============ \]</span></td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="center">n</td>
<td align="right"><span class="math display">\[ \sum_{t=1}^{n}\mathbf{X^2_t} \]</span></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[~~~~\]</span></p>
<p>In JDemetra+, the periodogram of <span class="math display">\[ \mathbf{X} \in \mathbb{R}^n \]</span> is computed for the standardized time series.</p>
<p>This scenario is designed for advanced users interested in an in-depth analysis of
time series in the frequency domain using three spectral graphs. Those
graphs can also be used as a complementary analysis for a better
understanding of the results obtained with some of the tests described
above.</p>
<p>Economic time series are usually presented in a time domain (X-axis).
However, for analytical purposes it is convenient to convert the
series to a frequency domain due to the fact that any stationary time
series can be expressed as a combination of cosine (or sine) functions.
These functions are characterized with different periods (amount of time
to complete a full cycle) and amplitudes (maximum/minimum value during
the cycle).</p>
<p>The tool used for the analysis of a time series in a frequency domain is
called a spectrum. The peaks in the spectrum indicate the presence of
cyclical movements with periodicity between two months and one year. A seasonal
series should have peaks at the seasonal
frequencies. Calendar adjusted data are not expected to have peak at with a
calendar frequency.</p>
<p>The periodicity of the phenomenon at frequency <em>f</em> is <span class="math inline">\(\frac{2\pi}{f}\)</span>. It
means that for a monthly time series the seasonal frequencies
<span class="math inline">\(\frac{\pi}{6},\ \frac{\pi}{3},\ \frac{\pi}{2},\ \frac{2\pi}{3},\ \frac{5\pi}{6}\ \)</span>
and <span class="math inline">\(\pi\)</span> correspond to 1, 2, 3, 4, 5 and 6 cycles per year. For
example, the frequency <span class="math inline">\(\frac{\pi}{3}\)</span> corresponds to a periodicity of 6
months (2 cycles per year are completed). For the quarterly series there
are two seasonal frequencies: <span class="math inline">\(\frac{\pi}{2}\)</span> (one cycle per year) and
<span class="math inline">\(\pi\)</span> (two cycles per year). A peak at the zero frequency always
corresponds to the trend component of the series. Seasonal frequencies
are marked as grey vertical lines, while violet vertical lines represent the
trading-days frequencies. The trading day frequency is 0.348 and derives
from the fact that a daily component which repeats every seven days goes
through 4.348 cycles in a month of average length 30.4375 days. It is
therefore seen to advance 0.348 cycles per month when the data are
obtained at twelve equally spaced times in 365.25 days (the average
length of a year).</p>
<p>The interpretation of the spectral graph is rather straightforward. When
the values of a spectral graph for low frequencies (i.e. one year and
more) are large in relation to its other values it means that the
long-term movements dominate in the series. When the values of a
spectral graph for high frequencies (i.e. below one year) are large in
relation to its other values it means that the series are rather
trendless and contains a lot of noise. When the values of a spectral
graph are distributed randomly around a constant without any visible
peaks, then it is highly probable that the series is a random process.
The presence of seasonality in a time series is manifested in a spectral
graph by the peaks on the seasonal frequencies.</p>
<p>A time series <span class="math display">\[x_{t}\]</span> with stationary covariance, mean <span class="math inline">\(μ\)</span> and
<span class="math display">\[k^{th}\]</span> autocovariance
<span class="math inline">\(E\left( \left( x_{t} - \mu \right)\left( x_{t - k} - \mu \right) \right) = \gamma(k)\$ can be described as a weighted sum of periodic trigonometric functions: sin\)</span>(t)$ and cos<span class="math inline">\((\omega t)\)</span>, where <span class="math inline">\(\omega\)</span> denotes frequency.
Spectral analysis investigates this frequency domain representation of
<span class="math inline">\(x_{t}\)</span> to determine how important cycles of different frequencies are
in accounting for the behaviour of <span class="math inline">\(x_{t}\)</span>.</p>
<p>Assuming that the autocovariances <span class="math inline">\(\gamma(k)\)</span> are absolutely summable
(<span class="math inline">\(\sum_{k = - \infty}^{\infty}\left| \gamma(k) \right| &lt; \infty\)</span>), the
autocovariance generating function, which summarises these
autocovariances through a scalar valued function, is given by equation
<span class="math display">\[1\]</span><a href="#fn65" class="footnote-ref" id="fnref65"><sup>65</sup></a>.</p>
<p><span class="math inline">\(acgf(z) = \sum_{k = - \infty}^{\infty}{z^{k}\gamma(k)}\)</span>,</p>
<p>where <span class="math inline">\(z\)</span> denotes complex scalar.</p>
<p>Once the equation <span class="math display">\[1\]</span><!---\[7.98\]--> is divided by <span class="math inline">\(\pi\)</span> and evaluated at some
<span class="math inline">\(z{= e}^{- i\omega} = cos\omega - isin\omega\)</span>, where <span class="math inline">\(i = \sqrt{- 1}\)</span>
and <span class="math inline">\(\omega\)</span> is a real scalar,<span class="math inline">\(\  - \infty &lt; \ \omega &lt; \infty\)</span>, the
result of this transformation is called a population spectrum
<span class="math inline">\(f\left( \omega \right)\ \)</span>for <span class="math inline">\(\ x_{t}\)</span>, given in equation <span class="math display">\[2\]</span><a href="#fn66" class="footnote-ref" id="fnref66"><sup>66</sup></a>.</p>
<p><span class="math display">\[f\left( \omega \right) = \frac{1}{\pi}\sum_{k = - \infty}^{\infty}{e^{- ik\omega}\gamma(k)}\]</span></p>
<p>Therefore, the analysis of the population spectrum in the frequency
domain is equivalent to the examination of the autocovariance function
in the time domain analysis; however it provides an alternative way of
inspecting the process. Because <span class="math inline">\(f\left( \omega \right)\text{dω}\)</span> is
interpreted as a contribution to the variance of components with
frequencies in the range <span class="math inline">\((\omega,\ \omega + d\omega)\)</span>, a peak in the
spectrum indicates an important contribution to the variance at
frequencies near the value that corresponds to this peak.</p>
<p>As <span class="math inline">\(e^{- i\omega} = cos\omega - isin\omega,\ \)</span>the spectrum can be also
expressed as in equation <span class="math display">\[3\]</span>.</p>
<p><span class="math display">\[f\left( \omega \right) = \frac{1}{\pi}\sum_{k = - \infty}^{\infty}{(cos\omega k - isin\omega k)\gamma(k)}\]</span></p>
<p>Since <span class="math inline">\(\gamma(k) = \gamma( - k)\)</span> (i.e. <span class="math inline">\(\gamma(k)\ \)</span>is an even function
of <span class="math inline">\(k\)</span>) and <span class="math inline">\(\sin{( - x)}\  = \operatorname{-sin}x\)</span>, <span class="math display">\[3\]</span><!---\[7.100\]--> can be
presented as equation</p>
<p><span class="math display">\[f\left( \omega \right) = \frac{1}{\pi}\left\lbrack \ \gamma(0) + 2\sum_{k = 1}^{\infty}{\ \gamma(k)}cos\text{ωk} \right\rbrack\]</span>,</p>
<p>This implies that if autocovariances are absolutely summable the
population spectrum exists and is a continuous, real-valued function of
<span class="math inline">\(\omega\)</span>. Due to the properties of trigonometric functions
<span class="math inline">\(\left( \cos\left( - \omega k \right) = \cos\left( \text{ωk} \right) \right.\ \ \)</span>and
<span class="math inline">\(\left. \ \cos\left( \omega + 2\pi j)k = cos(\omega k \right) \right)\ \)</span>the
spectrum is a periodic, even function of <span class="math inline">\(\omega\)</span>, symmetric around
<span class="math inline">\(\omega = 0\)</span>. Therefore, the analysis of the spectrum can be reduced to
the interval <span class="math inline">\(( - \pi,\pi).\)</span> The spectrum is nonnegative for all
<span class="math inline">\(\omega \in ( - \pi,\pi)\)</span>.</p>
<p>The shortest cycle that can be distinguished in a time series lasts two
periods. The frequency which corresponds to this cycle is <span class="math inline">\(\omega = \pi\)</span>
and is called the Nyquist frequency. The frequency of the longest cycles
that can be observed in the time series with <span class="math inline">\(n\)</span> observations is
<span class="math inline">\(\omega = \frac{2\pi}{n}\)</span> and is called the fundamental (Fourier)
frequency.</p>
<p>Note that if <span class="math display">\[x_{t}\]</span> is a white noise process with zero mean and
variance <span class="math display">\[\sigma^{2}\]</span>, then for all <span class="math display">\[\left| k \right| &gt; 0\]</span>
<span class="math display">\[\gamma\left(k\right)=0\]</span> and the spectrum of <span class="math display">\[x_{t}\]</span> is constant
(<span class="math display">\[f\left(\omega\right)= \frac{\sigma^{2}}{\pi}\]</span>) since each frequency
in the specrum contributes equally to the variance of the process<a href="#fn67" class="footnote-ref" id="fnref67"><sup>67</sup></a>.</p>
<p>The aim of spectral analysis is to determine how important cycles of
different frequencies are in accounting for the behaviour of a time
series<a href="#fn68" class="footnote-ref" id="fnref68"><sup>68</sup></a>. Since spectral analysis can be used to detect the presence
of periodic components, it is a natural diagnostic tool for detecting
trading day effects as well as seasonal effects<a href="#fn69" class="footnote-ref" id="fnref69"><sup>69</sup></a>. Among the tools
used for spectral analysis are the autoregressive spectrum and the
periodogram.</p>
<p>The explanations given in the subsections of this node derive mainly from DE
ANTONIO, D., and PALATE, J. (2015) and BROCKWELL, P.J., and DAVIS, R.A.
(2006).</p>
<p>The estimator of the spectral density at frequency <span class="math display">\[\lambda \in [0,\pi]\]</span> will be given by the assumption that the series will follow
an AR(p) process with large <span class="math display">\[p\]</span>. The spectral density of such model, with an innovation variance <span class="math display">\[ var(x_{t})=\sigma^2_x \]</span>, is expressed
as follows:</p>
<p><span class="math display">\[
10\times log_{10} f_x(\lambda)=10\times log_{10} \frac{\sigma^2_x}{2\pi \left|\phi(e^{i\lambda}) \right|^2 }=10\times log_{10} \frac{\sigma^2_x}{2\pi \left|1-\sum_{k=1}^{p}\phi_k e^{i k \lambda}) \right|^2 }
\]</span></p>
<p>where <span class="math display">\[ \phi_k \]</span> denotes the AR(k) coefficient, and <span class="math display">\[ e^{-ik\lambda}=cos⁡(-ik\lambda)+i sin⁡(-ik\lambda)\]</span>.</p>
<p>Soukup and Findely (1999) suggest the use of p=30, which in practice much larger than the order that would result from the AIC criterion.
The minimum number of observations needed to compute the spectrum is set to <em>n=80</em> for monthly data (or <em>n=60</em>) for quarterly series.
In turn, the maximum number of observations considered for the estimation is <em>n=121</em>. This choice offers enough resolution,
being able to identify a maximum of 30 peaks in a plot of 61 frequencies: by choosing <span class="math display">\[ \lambda_j=\pi j/60 \]</span>,for <span class="math display">\[ j=0,1,…,60 \]</span>, we are able to
calculate our density estimates at exact seasonal frequencies (1, 2, 3, 4, 5 and 6 cycles per year). Note that <span class="math display">\[x\]</span> cycles per year can be converted
into cycles per month by simply dividing by twelve, <span class="math display">\[x/12\]</span>, and to radians by applying the transformation <span class="math display">\[2\pi(x/12)\]</span>.</p>
<p>The traditional trading day frequency corresponding to 0.348 cycles per month is used in place of the closest frequency <span class="math display">\[\pi j/60\]</span>. Thus, we replace <span class="math display">\[\pi 42/60\]</span>
by <span class="math display">\[\lambda_{42}=0.348\times 2 \pi = 2.1865 \]</span>. The frequencies neighbouring <span class="math display">\[ \lambda_{42}\]</span> are set to <span class="math display">\[ \lambda_{41}= 2.1865-1/60 \]</span> and <span class="math display">\[\lambda_{43}= 2.1865+1/60\]</span>.
The periodogram below illustrates the proximity of this trading day frequency <span class="math display">\[\lambda_{42}\]</span> (red shade) and the frequency corresponding
to 4 cycles per year <span class="math display">\[\lambda_{40}=2.0944\]</span>. This proximity is precisely what poses the identification problems: the AR spectrum boils down to a smoothed version of the periodogram and the
contribution of the of the trading day frequency may be obscured by the leakage resulting from the potential seasonal peak at <span class="math display">\[\lambda_{40}\]</span>, and vice-versa.</p>
<div class="figure">
<img src="All_imagesUG_A_image19.png" alt="" />
<p class="caption">Text</p>
</div>
<p><strong>Periodogram with seasonal (grey) and calendar (red)
frequencies highlighted</strong></p>
<p>JDemetra+ allows the user to modify the number of lags of this estimator and to change the number of
observations used to determine the AR parameters. These two options can improve the resolution of this estimator.</p>
<div class="figure">
<img src="All_images/spectrum.png" alt="" />
<p class="caption">artest</p>
</div>
</div>
</div>
<div id="autoregressive-spectrum-estimation" class="section level2 hasAnchor" number="17.3">
<h2><span class="header-section-number">17.3</span> Autoregressive spectrum estimation<a href="spectral-analysis-principles-and-tools.html#autoregressive-spectrum-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>BROCKWELL, P.J., and DAVIS, R.A. (2006) point out that for any
real-valued stationary process <span class="math inline">\(\left\(x_{t}\right\)\)</span> with continuous spectral
density <span class="math inline">\(f\left\(\omega\right\)\)</span> it is possible to find both
<span class="math inline">\(AR(p)\)</span> and <span class="math inline">\(MA(q)\)</span> processes which spectral densities are arbitrarily
close to <span class="math inline">\(f\left\(\omega\right)\)</span>. For this reason, in some sense,
<span class="math inline">\(\left\(x_{t}\right\)\)</span> can be approximated by either <span class="math inline">\(AR(p)\)</span> or <span class="math inline">\(MA(q)\)</span>
process. This fact is a basis of one of the methods of achieving a
consistent estimator of the spectrum, which is called an autoregressive
spectrum estimation. It is based on the approximation of the stochastic
process <span class="math inline">\(\left\(x_{t}\right\)\)</span> by an autoregressive process of
sufficiently high order <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
  x_{t} = \mu + \left( \phi_{1}B + \ldots + \phi_{p}B^{p} \right)x_{t} + \varepsilon_{t}
  \]</span></p>
<p>where <span class="math display">\[\varepsilon_{t}\]</span> is a white-noise variable with mean zero and a
constant variance.</p>
<p>The autoregressive spectrum estimator for the series <span class="math inline">\(x_{t}\)</span> is defined
as: <a href="#fn70" class="footnote-ref" id="fnref70"><sup>70</sup></a></p>
<p><span class="math display">\[
\widehat{s}\left( \omega \right) = 10\operatorname{\times}{\log_{10}\frac{\sigma_{x}^{2}}{2\pi{|1 - \sum_{k = 1}^{p}{\widehat{\phi}}_{k}e^{- ik\omega}|}^{2}}}
\]</span></p>
<p>where:</p>
<p><span class="math inline">\(\omega\)</span>– frequency, <span class="math inline">\(0 \leq \omega \leq \pi\)</span>;</p>
<p><span class="math inline">\(\sigma_{x}^{2}\)</span> – the innovation variance of the sample residuals;</p>
<p><span class="math display">\[{\widehat{\phi}}_{k}\]</span> – <span class="math inline">\(\text{AR}\left\(k\right\)\)</span> coefficient
estimates of the linear regression of <span class="math inline">\(x_{t} - \overline{x}\)</span> on
<span class="math inline">\(x_{t - k} - \overline{x}\)</span>, <span class="math inline">\(1 \leq k \leq p\)</span>.</p>
<p>The autoregressive spectrum estimator is used in the visual spectral
analysis tool for detecting significant peaks in the spectrum. The
criterion of <em>visual significance</em>, implemented in JDemetra+, is based
on the range <span class="math inline">\({\widehat{s}}^{\max} - {\widehat{s}}^{\min}\)</span> of the
<span class="math inline">\(\widehat{s}\left( \omega \right)\)</span> values, where
<span class="math inline">\({\widehat{s}}^{\max} = \max_{k}\widehat{s}\left( \omega_{k} \right)\)</span>;
<span class="math inline">\({\widehat{s}}^{\min} = \min_{k}\widehat{s}\left( \omega_{k} \right);\)</span>
and <span class="math inline">\(\widehat{s}\left( \omega_{k} \right)\ \)</span>is <span class="math inline">\(k^{\text{th}}\)</span> value of
autoregressive spectrum estimator.</p>
<p>The particular value is considered to be visually significant if, at a
trading day or at a seasonal frequency <span class="math inline">\(\omega_{k}\)</span> (other than the
seasonal frequency <span class="math inline">\(\omega_{60} = \pi\)</span>),
<span class="math inline">\(\widehat{s}\left( \omega_{k} \right)\ \)</span>is above the median of the
plotted values of <span class="math inline">\(\widehat{s}\left( \omega_{k} \right)\)</span> and is larger
than both neighbouring values <span class="math inline">\(\widehat{s}\left( \omega_{k - 1} \right)\)</span>
and <span class="math inline">\(\widehat{s}\left( \omega_{k + 1} \right)\)</span> by at least
<span class="math inline">\(\frac{6}{52}\)</span> times the range
<span class="math inline">\({\widehat{s}}^{\max} - {\widehat{s}}^{\min}\)</span>.</p>
<p>Following the suggestion of SOUKUP, R.J., and FINDLEY, D.F. (1999),
JDemetra+ uses an autoregressive model spectral estimator of model order 30. This order yields high resolution of strong components, meaning peaks that are sharply defined in the plot of
<span class="math inline">\(\widehat{s}\left( \omega \right)\)</span> with 61 frequencies. The minimum
number of observations needed to compute the spectrum is set to <span class="math inline">\(n =\)</span> 80
for monthly data and to <span class="math inline">\(n =\)</span> 60 for quarterly series while the maximum
number of observations considered for the estimation is 121.
Consequently, with these settings it is possible to identify up to 30
peaks in the plot of 61 frequencies. By choosing
<span class="math inline">\(\omega_{k} = \frac{\text{πk}}{60}\)</span> for $k = $0,1,…,60 the density
estimates are calculated at exact seasonal frequencies
(1, 2, 3, 4, 5 and 6 cycles per year).</p>
<p>The model order can also be selected based on the AIC criterion (in
practice it is much lower than 30). A lower order produces the smoother
spectrum, but the contrast between the spectral amplitudes at the
trading day frequencies and neighbouring frequencies is weaker, and
therefore not as suitable for automatic detection.</p>
<p>SOUKUP, R.J., and FINDLEY, D.F. (1999) also explain that the periodogram
can be used in the <em>visual significance</em> test as it has as good as those
of the AR(30) spectrum abilities to detect trading day effect, but also
has a greater false alarm rate<a href="#fn71" class="footnote-ref" id="fnref71"><sup>71</sup></a>.</p>
<div id="use-2" class="section level4 hasAnchor" number="17.3.0.1">
<h4><span class="header-section-number">17.3.0.1</span> Use<a href="spectral-analysis-principles-and-tools.html#use-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The test can be applied directly to any series by selecting the
option <em>Statistical Methods &gt;&gt; Seasonal Adjustment &gt;&gt; Tools &gt;&gt; Seasonality Tests</em>. This is
an example of how results are displayed for the case of a monthly series:</p>
<p>JDemetra+ considers critical values for <span class="math display">\[ \alpha=1\%\]</span> (code “A”) and <span class="math display">\[ \alpha=5\%\]</span> (code “a”) at each one of the seasonal
frequencies represented in the table below, e.g. frequencies <span class="math inline">\(\frac{\pi}{6},\ \frac{\pi}{3},\ \frac{\pi}{2},\ \frac{2\pi}{3}\text{ and } \frac{5\pi}{6}\ \)</span> corresponding
to 1, 2, 3, 4, 5 and 6 cycles per year in this example, since we are dealing with monthly
data. The codes “t” and “T” correpond to the so-called
<a href="%7B%7B%20site.baseurl%20%7D%7D/pages/theory/Tests_TKspectrum.html">Tukey spectrum</a>, so ignore them for the moment.</p>
<p><strong>The seasonal and trading day frequencies by time series
frequency</strong></p>
<table>
<colgroup>
<col width="23%" />
<col width="53%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Number of months per full period</strong></th>
<th><strong>Seasonal frequency</strong></th>
<th><strong>Trading day frequency (radians)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>12</td>
<td><span class="math inline">\(\frac{\pi}{6},\frac{\pi}{3},\ \frac{\pi}{2},\frac{2\pi}{3},\ \frac{5\pi}{6},\ \pi\)</span></td>
<td><span class="math inline">\(d\)</span>, 2.714</td>
</tr>
<tr class="even">
<td>6</td>
<td><span class="math inline">\(\frac{\pi}{3},\frac{2\pi}{3}\)</span>, <span class="math inline">\(\pi\)</span></td>
<td><span class="math display">\[d\]</span></td>
</tr>
<tr class="odd">
<td>4</td>
<td><span class="math inline">\(\frac{\pi}{2}\)</span>, <span class="math inline">\(\pi\)</span></td>
<td><span class="math inline">\(d\)</span>, 1.292, 1.850, 2.128</td>
</tr>
<tr class="even">
<td>3</td>
<td><span class="math display">\[\pi\]</span></td>
<td><span class="math display">\[d\]</span></td>
</tr>
<tr class="odd">
<td>2</td>
<td><span class="math display">\[\pi\]</span></td>
<td><span class="math display">\[d\]</span></td>
</tr>
</tbody>
</table>
<p>Currently, only seasonal frequencies are tested, but the program allows you to manually plot the AR spectrum and focus your attention on both seasonal
and trading day frequencies. Agustin Maravall has conducted a
simulation experiment to calculate <span class="math display">\[ CV(\lambda_{42}) \]</span> (trading day frequency) and proposes to set for all <span class="math display">\[j\]</span> equal
to the critical value associated to the trading frequency, but this is currently not part of the current automatic testing procedure of JDemetra+.</p>
</div>
<div id="references-5" class="section level4 hasAnchor" number="17.3.0.2">
<h4><span class="header-section-number">17.3.0.2</span> References<a href="spectral-analysis-principles-and-tools.html#references-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Soukup, R.J., and D.F. Findley (1999) On the Spectrum Diagnosis used by X12-ARIMA to Indicate the Presence of Trading Day Effects After Modeling or Adjustment. In Proceedengs of the American Statistical Association. Business and Economic Statistics Section, 144-149, Alexandria, VA.</li>
</ul>
</div>
</div>
<div id="tukey-spectrum-definition" class="section level2 hasAnchor" number="17.4">
<h2><span class="header-section-number">17.4</span> Tukey Spectrum definition<a href="spectral-analysis-principles-and-tools.html#tukey-spectrum-definition" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Tukey spectrum belongs to the class of lag-window estimators. A lag window estimator of the spectral density
<span class="math display">\[
f(\omega)=\frac{1}{2\pi}\sum_{k&lt;-\infty}^{\infty}\gamma(k)e^{i k \omega}
\]</span>
is defined as follows:
<span class="math display">\[
\hat{f}_{L}(\omega)=\frac{1}{2\pi}\sum_{\left| h \right| \leq r } w(h/r)\hat{\gamma}(h)e^{i h \omega}
\]</span></p>
<p>where <span class="math display">\[\hat{\gamma}(.) \]</span> is the sample autocovariance function, <span class="math display">\[w(.)\]</span> is the lag window, and <span class="math display">\[r\]</span> is the
truncation lag. <span class="math display">\[\left| w(x)\right| \]</span> is always less than or equal to one, <span class="math display">\[w(0)=1\]</span> and <span class="math display">\[w(x)=0\]</span> for <span class="math display">\[\left| x \right| &gt; 1\]</span>. The
simple idea behind this formula is to down-weight the autocovariance function for high lags where <span class="math display">\[\hat{\gamma}(h)\]</span> is more unreliable. This estimator
requires choosing <span class="math display">\[r\]</span> as a function of the sample size such that <span class="math display">\[r/n \rightarrow 0 \]</span> and <span class="math display">\[r\rightarrow \infty \]</span> when <span class="math display">\[ n \rightarrow \infty \]</span> .
These conditions guarantee that the estimator converges to the true density.</p>
<p>JDemetra+ implements the so-called Blackman-Tukey (or Tukey-Hanning) estimator, which is given
by <span class="math display">\[w(h/r)=0.5(1+cos(\pi h/r))\]</span> if <span class="math display">\[\left| h/r \right| \leq 1\]</span> and <span class="math display">\[0\]</span> otherwise.</p>
<p>The choice of large truncation lags <span class="math display">\[r\]</span> decreases the bias, of course, but it also increases the variance of the spectral estimate and decreases the bandwidth.</p>
<p>JDemetra+ allows the user to modify all the parameters of this estimator, including the window function.</p>
<div id="theoretical-spectrum-of-the-arima-model-1" class="section level3 hasAnchor" number="17.4.1">
<h3><span class="header-section-number">17.4.1</span> Theoretical spectrum of the ARIMA model<a href="spectral-analysis-principles-and-tools.html#theoretical-spectrum-of-the-arima-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>link to graph display in GUI</p>
<p>In the bottom part the panel <a href="../theory/SA_lin.html">the ARIMA model</a> used by TRAMO is presented
using symbolic notation \((P,D,Q)(PB,DB,QB)\). Estimated
parameters’ coefficients (regular and seasonal AR and MA) are shown in
closed form (i.e. using the backshift operator<a href="#fn72" class="footnote-ref" id="fnref72"><sup>72</sup></a> \(B\)). For each
regular AR root (i.e. the solution of the characteristic equation) the
<a href="../theory/SA_SEATS.html#derivation-of-the-models-for-the-components">argument and modulus</a> are given.</p>
<div class="figure">
<img src="All_images/RM_C_pic03.jpg" alt="" />
<p class="caption">Text</p>
</div>
<p><strong>The details of ARIMA model used for modelling</strong></p>
<p>For each regular AR root the argument and modulus are also reported (if
present, i.e. if \(\)) to inform to which time series
component the regular roots would be assigned.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="61">
<li id="fn61"><p>BROCKWELL, P.J., and DAVIS, R.A. (2002).<a href="spectral-analysis-principles-and-tools.html#fnref61" class="footnote-back">↩︎</a></p></li>
<li id="fn62"><p>For details see BROCKWELL, P.J., and DAVIS, R.A. (2006).<a href="spectral-analysis-principles-and-tools.html#fnref62" class="footnote-back">↩︎</a></p></li>
<li id="fn63"><p>BOX, G.E.P., JENKINS, G.M., and REINSEL, G.C. (2007).<a href="spectral-analysis-principles-and-tools.html#fnref63" class="footnote-back">↩︎</a></p></li>
<li id="fn64"><p>The proof is given in BROCKWELL, P.J., and DAVIS, R.A. (2006).<a href="spectral-analysis-principles-and-tools.html#fnref64" class="footnote-back">↩︎</a></p></li>
<li id="fn65"><p>HAMILTON, J.D. (1994).<a href="spectral-analysis-principles-and-tools.html#fnref65" class="footnote-back">↩︎</a></p></li>
<li id="fn66"><p>HAMILTON, J.D. (1994).<a href="spectral-analysis-principles-and-tools.html#fnref66" class="footnote-back">↩︎</a></p></li>
<li id="fn67"><p>BROCKWELL, P.J., and DAVIS, R.A. (2002).<a href="spectral-analysis-principles-and-tools.html#fnref67" class="footnote-back">↩︎</a></p></li>
<li id="fn68"><p>HAMILTON, J.D. (1994).<a href="spectral-analysis-principles-and-tools.html#fnref68" class="footnote-back">↩︎</a></p></li>
<li id="fn69"><p>SOKUP, R.J., and FINDLEY, D. F. (1999).
## AR Spectrum definition<a href="spectral-analysis-principles-and-tools.html#fnref69" class="footnote-back">↩︎</a></p></li>
<li id="fn70"><p>Definition from ‘<em>X-12-ARIMA Reference Manual</em>’ (2011).<a href="spectral-analysis-principles-and-tools.html#fnref70" class="footnote-back">↩︎</a></p></li>
<li id="fn71"><p>The false alarm rate is defined as the fraction of the 50
replicates for which a visually significant spectral peak occurred
at one of the trading day frequencies being considered in the
designated output spectra (SOUKUP, R.J., and FINDLEY, D.F. (1999)).<a href="spectral-analysis-principles-and-tools.html#fnref71" class="footnote-back">↩︎</a></p></li>
<li id="fn72"><p>GÓMEZ, V., and MARAVALL, A. (2001b).<a href="spectral-analysis-principles-and-tools.html#fnref72" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tool-selection-issues.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reg-arima-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/17-Meth-Spectral_Analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
